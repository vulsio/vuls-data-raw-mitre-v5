{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.1",
	"cveMetadata": {
		"cveId": "CVE-2021-0243",
		"assignerOrgId": "8cbe9d5a-a066-4c94-8978-4b15efeae968",
		"assignerShortName": "juniper",
		"state": "PUBLISHED",
		"datePublished": "2021-04-22T19:37:08.073257Z",
		"dateUpdated": "2024-09-17T00:51:52.928Z",
		"dateReserved": "2020-10-27T00:00:00"
	},
	"containers": {
		"cna": {
			"providerMetadata": {
				"orgID": "8cbe9d5a-a066-4c94-8978-4b15efeae968",
				"shortName": "juniper",
				"dateUpdated": "2021-04-22T19:37:07"
			},
			"title": "Junos OS: EX4300: Stateless firewall policer fails to discard traffic",
			"descriptions": [
				{
					"lang": "en",
					"value": "Improper Handling of Unexpected Data in the firewall policer of Juniper Networks Junos OS on EX4300 switches allows matching traffic to exceed set policer limits, possibly leading to a limited Denial of Service (DoS) condition. When the firewall policer discard action fails on a Layer 2 port, it will allow traffic to pass even though it exceeds set policer limits. Traffic will not get discarded, and will be forwarded even though a policer discard action is configured. When the issue occurs, traffic is not discarded as desired, which can be observed by comparing the Input bytes with the Output bytes using the following command: user@junos> monitor interface traffic Interface Link Input bytes (bps) Output bytes (bps) ge-0/0/0 Up 37425422 (82616) 37425354 (82616) <<<< egress ge-0/0/1 Up 37425898 (82616) 37425354 (82616) <<<< ingress The expected output, with input and output counters differing, is shown below: Interface Link Input bytes (bps) Output bytes (bps) ge-0/0/0 Up 342420570 (54600) 342422760 (54600) <<<< egress ge-0/0/1 Up 517672120 (84000) 342420570 (54600) <<<< ingress This issue only affects IPv4 policing. IPv6 traffic and firewall policing actions are not affected by this issue. This issue affects Juniper Networks Junos OS on the EX4300: All versions prior to 17.3R3-S10; 17.4 versions prior to 17.4R3-S3; 18.1 versions prior to 18.1R3-S11; 18.2 versions prior to 18.2R3-S6; 18.3 versions prior to 18.3R3-S4; 18.4 versions prior to 18.4R3-S6; 19.1 versions prior to 19.1R3-S3; 19.2 versions prior to 19.2R3-S1; 19.3 versions prior to 19.3R3-S1; 19.4 versions prior to 19.4R3; 20.1 versions prior to 20.1R2; 20.2 versions prior to 20.2R2."
				}
			],
			"affected": [
				{
					"vendor": "Juniper Networks",
					"product": "Junos OS",
					"platforms": [
						"EX4300"
					],
					"versions": [
						{
							"status": "affected",
							"versionType": "custom",
							"version": "unspecified",
							"lessThan": "17.3R3-S10"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "17.4",
							"lessThan": "17.4R3-S3"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "18.1",
							"lessThan": "18.1R3-S11"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "18.2",
							"lessThan": "18.2R3-S6"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "18.3",
							"lessThan": "18.3R3-S4"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "18.4",
							"lessThan": "18.4R3-S6"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "19.1",
							"lessThan": "19.1R3-S3"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "19.2",
							"lessThan": "19.2R3-S1"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "19.3",
							"lessThan": "19.3R3-S1"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "19.4",
							"lessThan": "19.4R3"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "20.1",
							"lessThan": "20.1R2"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "20.2",
							"lessThan": "20.2R2"
						}
					]
				}
			],
			"problemTypes": [
				{
					"descriptions": [
						{
							"type": "CWE",
							"lang": "en",
							"description": "CWE-241 Improper Handling of Unexpected Data Type",
							"cweId": "CWE-241"
						}
					]
				},
				{
					"descriptions": [
						{
							"type": "text",
							"lang": "en",
							"description": "Denial of Service (DoS)"
						}
					]
				}
			],
			"metrics": [
				{
					"cvssV3_1": {
						"version": "3.1",
						"vectorString": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:L",
						"attackVector": "ADJACENT_NETWORK",
						"attackComplexity": "LOW",
						"privilegesRequired": "NONE",
						"userInteraction": "NONE",
						"scope": "CHANGED",
						"confidentialityImpact": "NONE",
						"integrityImpact": "NONE",
						"availabilityImpact": "LOW",
						"baseScore": 4.7,
						"baseSeverity": "MEDIUM"
					}
				}
			],
			"workarounds": [
				{
					"lang": "en",
					"value": "There are no viable workarounds for this issue."
				}
			],
			"solutions": [
				{
					"lang": "en",
					"value": "The following software releases have been updated to resolve this specific issue: Junos OS 17.3R3-S10, 17.4R3-S3, 18.1R3-S11, 18.2R3-S6, 18.3R3-S4, 18.4R3-S6, 19.1R3-S3, 19.2R3-S1, 19.3R3-S1, 19.4R3, 20.1R2, 20.2R2, 20.3R1, and all subsequent releases."
				}
			],
			"exploits": [
				{
					"lang": "en",
					"value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
				}
			],
			"configurations": [
				{
					"lang": "en",
					"value": "A sample affected firewall policer configuration is shown below:\n\n  set interfaces ge-0/0/1 unit 0 family ethernet-switching filter input TEST-Policer\n  set firewall family ethernet-switching filter TEST-Policer term 1 from ip-source-address 10.1.1.0/24\n  set firewall family ethernet-switching filter TEST-Policer term 1 then accept\n  set firewall family ethernet-switching filter TEST-Policer term 1 then policer TEST-Policer-Bandwidth\n  set firewall policer TEST-Policer-Bandwidth if-exceeding bandwidth-limit 50k\n  set firewall policer TEST-Policer-Bandwidth if-exceeding burst-size-limit 1500\n  set firewall policer TEST-Policer-Bandwidth then discard"
				}
			],
			"references": [
				{
					"tags": [
						"x_refsource_MISC"
					],
					"url": "https://kb.juniper.net/JSA11136"
				}
			],
			"source": {
				"advisory": "JSA11136",
				"defect": [
					"1532670"
				],
				"discovery": "USER"
			},
			"datePublic": "2021-04-14T00:00:00",
			"x_generator": {
				"engine": "Vulnogram 0.0.9"
			},
			"x_legacyV4Record": {
				"CVE_data_meta": {
					"ASSIGNER": "sirt@juniper.net",
					"DATE_PUBLIC": "2021-04-14T16:00:00.000Z",
					"ID": "CVE-2021-0243",
					"STATE": "PUBLIC",
					"TITLE": "Junos OS: EX4300: Stateless firewall policer fails to discard traffic"
				},
				"affects": {
					"vendor": {
						"vendor_data": [
							{
								"product": {
									"product_data": [
										{
											"product_name": "Junos OS",
											"version": {
												"version_data": [
													{
														"platform": "EX4300",
														"version_affected": "<",
														"version_value": "17.3R3-S10"
													},
													{
														"platform": "EX4300",
														"version_affected": "<",
														"version_name": "17.4",
														"version_value": "17.4R3-S3"
													},
													{
														"platform": "EX4300",
														"version_affected": "<",
														"version_name": "18.1",
														"version_value": "18.1R3-S11"
													},
													{
														"platform": "EX4300",
														"version_affected": "<",
														"version_name": "18.2",
														"version_value": "18.2R3-S6"
													},
													{
														"platform": "EX4300",
														"version_affected": "<",
														"version_name": "18.3",
														"version_value": "18.3R3-S4"
													},
													{
														"platform": "EX4300",
														"version_affected": "<",
														"version_name": "18.4",
														"version_value": "18.4R3-S6"
													},
													{
														"platform": "EX4300",
														"version_affected": "<",
														"version_name": "19.1",
														"version_value": "19.1R3-S3"
													},
													{
														"platform": "EX4300",
														"version_affected": "<",
														"version_name": "19.2",
														"version_value": "19.2R3-S1"
													},
													{
														"platform": "EX4300",
														"version_affected": "<",
														"version_name": "19.3",
														"version_value": "19.3R3-S1"
													},
													{
														"platform": "EX4300",
														"version_affected": "<",
														"version_name": "19.4",
														"version_value": "19.4R3"
													},
													{
														"platform": "EX4300",
														"version_affected": "<",
														"version_name": "20.1",
														"version_value": "20.1R2"
													},
													{
														"platform": "EX4300",
														"version_affected": "<",
														"version_name": "20.2",
														"version_value": "20.2R2"
													}
												]
											}
										}
									]
								},
								"vendor_name": "Juniper Networks"
							}
						]
					}
				},
				"configuration": [
					{
						"lang": "en",
						"value": "A sample affected firewall policer configuration is shown below:\n\n  set interfaces ge-0/0/1 unit 0 family ethernet-switching filter input TEST-Policer\n  set firewall family ethernet-switching filter TEST-Policer term 1 from ip-source-address 10.1.1.0/24\n  set firewall family ethernet-switching filter TEST-Policer term 1 then accept\n  set firewall family ethernet-switching filter TEST-Policer term 1 then policer TEST-Policer-Bandwidth\n  set firewall policer TEST-Policer-Bandwidth if-exceeding bandwidth-limit 50k\n  set firewall policer TEST-Policer-Bandwidth if-exceeding burst-size-limit 1500\n  set firewall policer TEST-Policer-Bandwidth then discard"
					}
				],
				"data_format": "MITRE",
				"data_type": "CVE",
				"data_version": "4.0",
				"description": {
					"description_data": [
						{
							"lang": "eng",
							"value": "Improper Handling of Unexpected Data in the firewall policer of Juniper Networks Junos OS on EX4300 switches allows matching traffic to exceed set policer limits, possibly leading to a limited Denial of Service (DoS) condition. When the firewall policer discard action fails on a Layer 2 port, it will allow traffic to pass even though it exceeds set policer limits. Traffic will not get discarded, and will be forwarded even though a policer discard action is configured. When the issue occurs, traffic is not discarded as desired, which can be observed by comparing the Input bytes with the Output bytes using the following command: user@junos> monitor interface traffic Interface Link Input bytes (bps) Output bytes (bps) ge-0/0/0 Up 37425422 (82616) 37425354 (82616) <<<< egress ge-0/0/1 Up 37425898 (82616) 37425354 (82616) <<<< ingress The expected output, with input and output counters differing, is shown below: Interface Link Input bytes (bps) Output bytes (bps) ge-0/0/0 Up 342420570 (54600) 342422760 (54600) <<<< egress ge-0/0/1 Up 517672120 (84000) 342420570 (54600) <<<< ingress This issue only affects IPv4 policing. IPv6 traffic and firewall policing actions are not affected by this issue. This issue affects Juniper Networks Junos OS on the EX4300: All versions prior to 17.3R3-S10; 17.4 versions prior to 17.4R3-S3; 18.1 versions prior to 18.1R3-S11; 18.2 versions prior to 18.2R3-S6; 18.3 versions prior to 18.3R3-S4; 18.4 versions prior to 18.4R3-S6; 19.1 versions prior to 19.1R3-S3; 19.2 versions prior to 19.2R3-S1; 19.3 versions prior to 19.3R3-S1; 19.4 versions prior to 19.4R3; 20.1 versions prior to 20.1R2; 20.2 versions prior to 20.2R2."
						}
					]
				},
				"exploit": [
					{
						"lang": "en",
						"value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
					}
				],
				"generator": {
					"engine": "Vulnogram 0.0.9"
				},
				"impact": {
					"cvss": {
						"attackComplexity": "LOW",
						"attackVector": "ADJACENT_NETWORK",
						"availabilityImpact": "LOW",
						"baseScore": 4.7,
						"baseSeverity": "MEDIUM",
						"confidentialityImpact": "NONE",
						"integrityImpact": "NONE",
						"privilegesRequired": "NONE",
						"scope": "CHANGED",
						"userInteraction": "NONE",
						"vectorString": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:L",
						"version": "3.1"
					}
				},
				"problemtype": {
					"problemtype_data": [
						{
							"description": [
								{
									"lang": "eng",
									"value": "CWE-241 Improper Handling of Unexpected Data Type"
								}
							]
						},
						{
							"description": [
								{
									"lang": "eng",
									"value": "Denial of Service (DoS)"
								}
							]
						}
					]
				},
				"references": {
					"reference_data": [
						{
							"name": "https://kb.juniper.net/JSA11136",
							"refsource": "MISC",
							"url": "https://kb.juniper.net/JSA11136"
						}
					]
				},
				"solution": [
					{
						"lang": "en",
						"value": "The following software releases have been updated to resolve this specific issue: Junos OS 17.3R3-S10, 17.4R3-S3, 18.1R3-S11, 18.2R3-S6, 18.3R3-S4, 18.4R3-S6, 19.1R3-S3, 19.2R3-S1, 19.3R3-S1, 19.4R3, 20.1R2, 20.2R2, 20.3R1, and all subsequent releases."
					}
				],
				"source": {
					"advisory": "JSA11136",
					"defect": [
						"1532670"
					],
					"discovery": "USER"
				},
				"work_around": [
					{
						"lang": "en",
						"value": "There are no viable workarounds for this issue."
					}
				]
			}
		},
		"adp": [
			{
				"providerMetadata": {
					"orgID": "af854a3a-2127-422b-91ae-364da2661108",
					"shortName": "CVE",
					"dateUpdated": "2024-08-03T15:32:10.168Z"
				},
				"title": "CVE Program Container",
				"references": [
					{
						"tags": [
							"x_refsource_MISC",
							"x_transferred"
						],
						"url": "https://kb.juniper.net/JSA11136"
					}
				]
			}
		]
	}
}
