{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.1",
	"cveMetadata": {
		"cveId": "CVE-2021-37634",
		"assignerOrgId": "a0819718-46f1-4df5-94e2-005712e83aaa",
		"assignerShortName": "GitHub_M",
		"state": "PUBLISHED",
		"datePublished": "2021-08-09T19:45:13",
		"dateUpdated": "2024-08-04T01:23:01.289Z",
		"dateReserved": "2021-07-29T00:00:00"
	},
	"containers": {
		"cna": {
			"providerMetadata": {
				"orgID": "a0819718-46f1-4df5-94e2-005712e83aaa",
				"shortName": "GitHub_M",
				"dateUpdated": "2021-08-09T19:45:13"
			},
			"title": "LeafKit allows XSS with untrusted user input",
			"descriptions": [
				{
					"lang": "en",
					"value": "Leafkit is a templating language with Swift-inspired syntax. Versions prior to 1.3.0 are susceptible to Cross-site Scripting (XSS) attacks. This affects anyone passing unsanitised data to Leaf's variable tags. Before this fix, Leaf would not escape any strings passed to tags as variables. If an attacker managed to find a variable that was rendered with their unsanitised data, they could inject scripts into a generated Leaf page, which could enable XSS attacks if other mitigations such as a Content Security Policy were not enabled. This has been patched in 1.3.0. As a workaround sanitize any untrusted input before passing it to Leaf and enable a CSP to block inline script and CSS data."
				}
			],
			"affected": [
				{
					"vendor": "vapor",
					"product": "leaf-kit",
					"versions": [
						{
							"status": "affected",
							"version": "< 1.3.0"
						}
					]
				}
			],
			"problemTypes": [
				{
					"descriptions": [
						{
							"type": "CWE",
							"lang": "en",
							"description": "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')",
							"cweId": "CWE-79"
						}
					]
				}
			],
			"metrics": [
				{
					"cvssV3_1": {
						"version": "3.1",
						"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:N/A:N",
						"attackVector": "NETWORK",
						"attackComplexity": "LOW",
						"privilegesRequired": "NONE",
						"userInteraction": "REQUIRED",
						"scope": "CHANGED",
						"confidentialityImpact": "HIGH",
						"integrityImpact": "NONE",
						"availabilityImpact": "NONE",
						"baseScore": 7.4,
						"baseSeverity": "HIGH"
					}
				}
			],
			"references": [
				{
					"tags": [
						"x_refsource_CONFIRM"
					],
					"url": "https://github.com/vapor/leaf-kit/security/advisories/GHSA-rv3x-xq3r-8j9h"
				},
				{
					"tags": [
						"x_refsource_MISC"
					],
					"url": "https://github.com/vapor/leaf-kit-ghsa-rv3x-xq3r-8j9h/pull/1"
				}
			],
			"source": {
				"advisory": "GHSA-rv3x-xq3r-8j9h",
				"discovery": "UNKNOWN"
			},
			"x_legacyV4Record": {
				"CVE_data_meta": {
					"ASSIGNER": "security-advisories@github.com",
					"ID": "CVE-2021-37634",
					"STATE": "PUBLIC",
					"TITLE": "LeafKit allows XSS with untrusted user input"
				},
				"affects": {
					"vendor": {
						"vendor_data": [
							{
								"product": {
									"product_data": [
										{
											"product_name": "leaf-kit",
											"version": {
												"version_data": [
													{
														"version_value": "< 1.3.0"
													}
												]
											}
										}
									]
								},
								"vendor_name": "vapor"
							}
						]
					}
				},
				"data_format": "MITRE",
				"data_type": "CVE",
				"data_version": "4.0",
				"description": {
					"description_data": [
						{
							"lang": "eng",
							"value": "Leafkit is a templating language with Swift-inspired syntax. Versions prior to 1.3.0 are susceptible to Cross-site Scripting (XSS) attacks. This affects anyone passing unsanitised data to Leaf's variable tags. Before this fix, Leaf would not escape any strings passed to tags as variables. If an attacker managed to find a variable that was rendered with their unsanitised data, they could inject scripts into a generated Leaf page, which could enable XSS attacks if other mitigations such as a Content Security Policy were not enabled. This has been patched in 1.3.0. As a workaround sanitize any untrusted input before passing it to Leaf and enable a CSP to block inline script and CSS data."
						}
					]
				},
				"impact": {
					"cvss": {
						"attackComplexity": "LOW",
						"attackVector": "NETWORK",
						"availabilityImpact": "NONE",
						"baseScore": 7.4,
						"baseSeverity": "HIGH",
						"confidentialityImpact": "HIGH",
						"integrityImpact": "NONE",
						"privilegesRequired": "NONE",
						"scope": "CHANGED",
						"userInteraction": "REQUIRED",
						"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:N/A:N",
						"version": "3.1"
					}
				},
				"problemtype": {
					"problemtype_data": [
						{
							"description": [
								{
									"lang": "eng",
									"value": "CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
								}
							]
						}
					]
				},
				"references": {
					"reference_data": [
						{
							"name": "https://github.com/vapor/leaf-kit/security/advisories/GHSA-rv3x-xq3r-8j9h",
							"refsource": "CONFIRM",
							"url": "https://github.com/vapor/leaf-kit/security/advisories/GHSA-rv3x-xq3r-8j9h"
						},
						{
							"name": "https://github.com/vapor/leaf-kit-ghsa-rv3x-xq3r-8j9h/pull/1",
							"refsource": "MISC",
							"url": "https://github.com/vapor/leaf-kit-ghsa-rv3x-xq3r-8j9h/pull/1"
						}
					]
				},
				"source": {
					"advisory": "GHSA-rv3x-xq3r-8j9h",
					"discovery": "UNKNOWN"
				}
			}
		},
		"adp": [
			{
				"providerMetadata": {
					"orgID": "af854a3a-2127-422b-91ae-364da2661108",
					"shortName": "CVE",
					"dateUpdated": "2024-08-04T01:23:01.289Z"
				},
				"title": "CVE Program Container",
				"references": [
					{
						"tags": [
							"x_refsource_CONFIRM",
							"x_transferred"
						],
						"url": "https://github.com/vapor/leaf-kit/security/advisories/GHSA-rv3x-xq3r-8j9h"
					},
					{
						"tags": [
							"x_refsource_MISC",
							"x_transferred"
						],
						"url": "https://github.com/vapor/leaf-kit-ghsa-rv3x-xq3r-8j9h/pull/1"
					}
				]
			}
		]
	}
}
