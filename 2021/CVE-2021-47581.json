{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.1",
	"cveMetadata": {
		"cveId": "CVE-2021-47581",
		"assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
		"assignerShortName": "Linux",
		"state": "PUBLISHED",
		"datePublished": "2024-06-19T14:53:48.111Z",
		"dateUpdated": "2024-06-19T14:53:48.111Z",
		"dateReserved": "2024-05-24T15:11:00.730Z"
	},
	"containers": {
		"cna": {
			"providerMetadata": {
				"orgID": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
				"shortName": "Linux",
				"dateUpdated": "2024-06-19T14:53:48.111Z"
			},
			"title": "xen/netback: don't queue unlimited number of packages",
			"descriptions": [
				{
					"lang": "en",
					"value": "In the Linux kernel, the following vulnerability has been resolved:\n\nxen/netback: don't queue unlimited number of packages\n\nIn case a guest isn't consuming incoming network traffic as fast as it\nis coming in, xen-netback is buffering network packages in unlimited\nnumbers today. This can result in host OOM situations.\n\nCommit f48da8b14d04ca8 (\"xen-netback: fix unlimited guest Rx internal\nqueue and carrier flapping\") meant to introduce a mechanism to limit\nthe amount of buffered data by stopping the Tx queue when reaching the\ndata limit, but this doesn't work for cases like UDP.\n\nWhen hitting the limit don't queue further SKBs, but drop them instead.\nIn order to be able to tell Rx packages have been dropped increment the\nrx_dropped statistics counter in this case.\n\nIt should be noted that the old solution to continue queueing SKBs had\nthe additional problem of an overflow of the 32-bit rx_queue_len value\nwould result in intermittent Tx queue enabling.\n\nThis is part of XSA-392"
				}
			],
			"affected": [
				{
					"vendor": "Linux",
					"product": "Linux",
					"programFiles": [
						"drivers/net/xen-netback/rx.c"
					],
					"repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
					"defaultStatus": "unaffected",
					"versions": [
						{
							"status": "affected",
							"versionType": "git",
							"version": "f48da8b14d04",
							"lessThan": "0928efb09178"
						},
						{
							"status": "affected",
							"versionType": "git",
							"version": "f48da8b14d04",
							"lessThan": "b4226b387436"
						},
						{
							"status": "affected",
							"versionType": "git",
							"version": "f48da8b14d04",
							"lessThan": "9bebb2eedf67"
						},
						{
							"status": "affected",
							"versionType": "git",
							"version": "f48da8b14d04",
							"lessThan": "c9f17e92917f"
						},
						{
							"status": "affected",
							"versionType": "git",
							"version": "f48da8b14d04",
							"lessThan": "0d99b3c6bd39"
						},
						{
							"status": "affected",
							"versionType": "git",
							"version": "f48da8b14d04",
							"lessThan": "88f20cccbeec"
						},
						{
							"status": "affected",
							"versionType": "git",
							"version": "f48da8b14d04",
							"lessThan": "bd926d189210"
						},
						{
							"status": "affected",
							"versionType": "git",
							"version": "f48da8b14d04",
							"lessThan": "be81992f9086"
						}
					]
				},
				{
					"vendor": "Linux",
					"product": "Linux",
					"programFiles": [
						"drivers/net/xen-netback/rx.c"
					],
					"repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
					"defaultStatus": "affected",
					"versions": [
						{
							"status": "affected",
							"version": "3.18"
						},
						{
							"status": "unaffected",
							"versionType": "custom",
							"version": "0",
							"lessThan": "3.18"
						},
						{
							"status": "unaffected",
							"versionType": "custom",
							"version": "4.4.296",
							"lessThanOrEqual": "4.4.*"
						},
						{
							"status": "unaffected",
							"versionType": "custom",
							"version": "4.9.294",
							"lessThanOrEqual": "4.9.*"
						},
						{
							"status": "unaffected",
							"versionType": "custom",
							"version": "4.14.259",
							"lessThanOrEqual": "4.14.*"
						},
						{
							"status": "unaffected",
							"versionType": "custom",
							"version": "4.19.222",
							"lessThanOrEqual": "4.19.*"
						},
						{
							"status": "unaffected",
							"versionType": "custom",
							"version": "5.4.168",
							"lessThanOrEqual": "5.4.*"
						},
						{
							"status": "unaffected",
							"versionType": "custom",
							"version": "5.10.88",
							"lessThanOrEqual": "5.10.*"
						},
						{
							"status": "unaffected",
							"versionType": "custom",
							"version": "5.15.11",
							"lessThanOrEqual": "5.15.*"
						},
						{
							"status": "unaffected",
							"versionType": "original_commit_for_fix",
							"version": "5.16",
							"lessThanOrEqual": "*"
						}
					]
				}
			],
			"references": [
				{
					"url": "https://git.kernel.org/stable/c/0928efb09178e01d3dc8e8849aa1c807436c3c37"
				},
				{
					"url": "https://git.kernel.org/stable/c/b4226b387436315e7f57465c15335f4f4b5b075d"
				},
				{
					"url": "https://git.kernel.org/stable/c/9bebb2eedf679b3be4acaa20efda97f32c999d74"
				},
				{
					"url": "https://git.kernel.org/stable/c/c9f17e92917fd5786be872626a3928979ecc4c39"
				},
				{
					"url": "https://git.kernel.org/stable/c/0d99b3c6bd39a0a023e972d8f912fd47698bbbb8"
				},
				{
					"url": "https://git.kernel.org/stable/c/88f20cccbeec9a5e83621df5cc2453b5081454dc"
				},
				{
					"url": "https://git.kernel.org/stable/c/bd926d189210cd1d5b4e618e45898053be6b4b3b"
				},
				{
					"url": "https://git.kernel.org/stable/c/be81992f9086b230623ae3ebbc85ecee4d00a3d3"
				}
			],
			"x_generator": {
				"engine": "bippy-a5840b7849dd"
			}
		}
	}
}
