{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.1",
	"cveMetadata": {
		"assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
		"assignerShortName": "Linux",
		"cveId": "CVE-2021-47317",
		"datePublished": "2024-05-21T14:35:33.212Z",
		"dateReserved": "2024-05-21T14:28:16.973Z",
		"dateUpdated": "2024-05-28T19:42:18.887Z",
		"state": "PUBLISHED"
	},
	"containers": {
		"cna": {
			"affected": [
				{
					"defaultStatus": "unaffected",
					"product": "Linux",
					"programFiles": [
						"arch/powerpc/net/bpf_jit_comp64.c"
					],
					"repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
					"vendor": "Linux",
					"versions": [
						{
							"lessThan": "7284dab07e4d",
							"status": "affected",
							"version": "91c960b00566",
							"versionType": "git"
						},
						{
							"lessThan": "0d435b6d94b0",
							"status": "affected",
							"version": "91c960b00566",
							"versionType": "git"
						},
						{
							"lessThan": "419ac821766c",
							"status": "affected",
							"version": "91c960b00566",
							"versionType": "git"
						}
					]
				},
				{
					"defaultStatus": "affected",
					"product": "Linux",
					"programFiles": [
						"arch/powerpc/net/bpf_jit_comp64.c"
					],
					"repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
					"vendor": "Linux",
					"versions": [
						{
							"status": "affected",
							"version": "5.12"
						},
						{
							"lessThan": "5.12",
							"status": "unaffected",
							"version": "0",
							"versionType": "custom"
						},
						{
							"lessThanOrEqual": "5.12.*",
							"status": "unaffected",
							"version": "5.12.19",
							"versionType": "custom"
						},
						{
							"lessThanOrEqual": "5.13.*",
							"status": "unaffected",
							"version": "5.13.4",
							"versionType": "custom"
						},
						{
							"lessThanOrEqual": "*",
							"status": "unaffected",
							"version": "5.14",
							"versionType": "original_commit_for_fix"
						}
					]
				}
			],
			"descriptions": [
				{
					"lang": "en",
					"value": "In the Linux kernel, the following vulnerability has been resolved:\n\npowerpc/bpf: Fix detecting BPF atomic instructions\n\nCommit 91c960b0056672 (\"bpf: Rename BPF_XADD and prepare to encode other\natomics in .imm\") converted BPF_XADD to BPF_ATOMIC and added a way to\ndistinguish instructions based on the immediate field. Existing JIT\nimplementations were updated to check for the immediate field and to\nreject programs utilizing anything more than BPF_ADD (such as BPF_FETCH)\nin the immediate field.\n\nHowever, the check added to powerpc64 JIT did not look at the correct\nBPF instruction. Due to this, such programs would be accepted and\nincorrectly JIT'ed resulting in soft lockups, as seen with the atomic\nbounds test. Fix this by looking at the correct immediate value."
				}
			],
			"providerMetadata": {
				"dateUpdated": "2024-05-28T19:42:18.887Z",
				"orgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
				"shortName": "Linux"
			},
			"references": [
				{
					"url": "https://git.kernel.org/stable/c/7284dab07e4d51d453cc42851fae9ec4fac6ef2f"
				},
				{
					"url": "https://git.kernel.org/stable/c/0d435b6d94b05dcfd836d758a63145aa566618e2"
				},
				{
					"url": "https://git.kernel.org/stable/c/419ac821766cbdb9fd85872bb3f1a589df05c94c"
				}
			],
			"title": "powerpc/bpf: Fix detecting BPF atomic instructions",
			"x_generator": {
				"engine": "bippy-a5840b7849dd"
			}
		}
	}
}
