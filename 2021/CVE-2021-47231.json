{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.1",
	"cveMetadata": {
		"cveId": "CVE-2021-47231",
		"assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
		"assignerShortName": "Linux",
		"state": "PUBLISHED",
		"datePublished": "2024-05-21T14:19:34.413Z",
		"dateUpdated": "2024-11-04T12:01:56.939Z",
		"dateReserved": "2024-04-10T18:59:19.530Z"
	},
	"containers": {
		"cna": {
			"providerMetadata": {
				"orgID": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
				"shortName": "Linux",
				"dateUpdated": "2024-11-04T12:01:56.939Z"
			},
			"title": "can: mcba_usb: fix memory leak in mcba_usb",
			"descriptions": [
				{
					"lang": "en",
					"value": "In the Linux kernel, the following vulnerability has been resolved:\n\ncan: mcba_usb: fix memory leak in mcba_usb\n\nSyzbot reported memory leak in SocketCAN driver for Microchip CAN BUS\nAnalyzer Tool. The problem was in unfreed usb_coherent.\n\nIn mcba_usb_start() 20 coherent buffers are allocated and there is\nnothing, that frees them:\n\n1) In callback function the urb is resubmitted and that's all\n2) In disconnect function urbs are simply killed, but URB_FREE_BUFFER\n   is not set (see mcba_usb_start) and this flag cannot be used with\n   coherent buffers.\n\nFail log:\n| [ 1354.053291][ T8413] mcba_usb 1-1:0.0 can0: device disconnected\n| [ 1367.059384][ T8420] kmemleak: 20 new suspected memory leaks (see /sys/kernel/debug/kmem)\n\nSo, all allocated buffers should be freed with usb_free_coherent()\nexplicitly\n\nNOTE:\nThe same pattern for allocating and freeing coherent buffers\nis used in drivers/net/can/usb/kvaser_usb/kvaser_usb_core.c"
				}
			],
			"affected": [
				{
					"vendor": "Linux",
					"product": "Linux",
					"programFiles": [
						"drivers/net/can/usb/mcba_usb.c"
					],
					"repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
					"defaultStatus": "unaffected",
					"versions": [
						{
							"status": "affected",
							"versionType": "git",
							"version": "51f3baad7de9",
							"lessThan": "89df95ce32be"
						},
						{
							"status": "affected",
							"versionType": "git",
							"version": "51f3baad7de9",
							"lessThan": "a115198caaab"
						},
						{
							"status": "affected",
							"versionType": "git",
							"version": "51f3baad7de9",
							"lessThan": "6f87c0e21ad2"
						},
						{
							"status": "affected",
							"versionType": "git",
							"version": "51f3baad7de9",
							"lessThan": "6bd3d80d1f01"
						},
						{
							"status": "affected",
							"versionType": "git",
							"version": "51f3baad7de9",
							"lessThan": "d0760a4ef856"
						},
						{
							"status": "affected",
							"versionType": "git",
							"version": "51f3baad7de9",
							"lessThan": "91c02557174b"
						}
					]
				},
				{
					"vendor": "Linux",
					"product": "Linux",
					"programFiles": [
						"drivers/net/can/usb/mcba_usb.c"
					],
					"repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
					"defaultStatus": "affected",
					"versions": [
						{
							"status": "affected",
							"version": "4.12"
						},
						{
							"status": "unaffected",
							"versionType": "semver",
							"version": "0",
							"lessThan": "4.12"
						},
						{
							"status": "unaffected",
							"versionType": "semver",
							"version": "4.14.238",
							"lessThanOrEqual": "4.14.*"
						},
						{
							"status": "unaffected",
							"versionType": "semver",
							"version": "4.19.196",
							"lessThanOrEqual": "4.19.*"
						},
						{
							"status": "unaffected",
							"versionType": "semver",
							"version": "5.4.128",
							"lessThanOrEqual": "5.4.*"
						},
						{
							"status": "unaffected",
							"versionType": "semver",
							"version": "5.10.46",
							"lessThanOrEqual": "5.10.*"
						},
						{
							"status": "unaffected",
							"versionType": "semver",
							"version": "5.12.13",
							"lessThanOrEqual": "5.12.*"
						},
						{
							"status": "unaffected",
							"versionType": "original_commit_for_fix",
							"version": "5.13",
							"lessThanOrEqual": "*"
						}
					]
				}
			],
			"references": [
				{
					"url": "https://git.kernel.org/stable/c/89df95ce32be204eef2e7d4b2f6fb552fb191a68"
				},
				{
					"url": "https://git.kernel.org/stable/c/a115198caaab6d663bef75823a3c5f0802306d60"
				},
				{
					"url": "https://git.kernel.org/stable/c/6f87c0e21ad20dd3d22108e33db1c552dfa352a0"
				},
				{
					"url": "https://git.kernel.org/stable/c/6bd3d80d1f019cefa7011056c54b323f1d8b8e83"
				},
				{
					"url": "https://git.kernel.org/stable/c/d0760a4ef85697bc756d06eae17ae27f3f055401"
				},
				{
					"url": "https://git.kernel.org/stable/c/91c02557174be7f72e46ed7311e3bea1939840b0"
				}
			],
			"x_generator": {
				"engine": "bippy-9e1c9544281a"
			}
		},
		"adp": [
			{
				"providerMetadata": {
					"orgID": "af854a3a-2127-422b-91ae-364da2661108",
					"shortName": "CVE",
					"dateUpdated": "2024-08-04T05:32:07.366Z"
				},
				"title": "CVE Program Container",
				"references": [
					{
						"tags": [
							"x_transferred"
						],
						"url": "https://git.kernel.org/stable/c/89df95ce32be204eef2e7d4b2f6fb552fb191a68"
					},
					{
						"tags": [
							"x_transferred"
						],
						"url": "https://git.kernel.org/stable/c/a115198caaab6d663bef75823a3c5f0802306d60"
					},
					{
						"tags": [
							"x_transferred"
						],
						"url": "https://git.kernel.org/stable/c/6f87c0e21ad20dd3d22108e33db1c552dfa352a0"
					},
					{
						"tags": [
							"x_transferred"
						],
						"url": "https://git.kernel.org/stable/c/6bd3d80d1f019cefa7011056c54b323f1d8b8e83"
					},
					{
						"tags": [
							"x_transferred"
						],
						"url": "https://git.kernel.org/stable/c/d0760a4ef85697bc756d06eae17ae27f3f055401"
					},
					{
						"tags": [
							"x_transferred"
						],
						"url": "https://git.kernel.org/stable/c/91c02557174be7f72e46ed7311e3bea1939840b0"
					}
				]
			},
			{
				"providerMetadata": {
					"orgID": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
					"shortName": "CISA-ADP",
					"dateUpdated": "2024-08-15T15:15:31.419Z"
				},
				"title": "CISA ADP Vulnrichment",
				"metrics": [
					{
						"other": {
							"type": "ssvc",
							"content": {
								"id": "CVE-2021-47231",
								"options": [
									{
										"Exploitation": "none"
									},
									{
										"Automatable": "no"
									},
									{
										"Technical Impact": "partial"
									}
								],
								"role": "CISA Coordinator",
								"timestamp": "2024-05-31T18:50:07.041810Z",
								"version": "2.0.3"
							}
						}
					}
				]
			}
		]
	}
}
