{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.1",
	"cveMetadata": {
		"assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
		"assignerShortName": "Linux",
		"cveId": "CVE-2021-47231",
		"datePublished": "2024-05-21T14:19:34.413Z",
		"dateReserved": "2024-04-10T18:59:19.530Z",
		"dateUpdated": "2024-05-29T05:04:20.985Z",
		"state": "PUBLISHED"
	},
	"containers": {
		"cna": {
			"affected": [
				{
					"defaultStatus": "unaffected",
					"product": "Linux",
					"programFiles": [
						"drivers/net/can/usb/mcba_usb.c"
					],
					"repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
					"vendor": "Linux",
					"versions": [
						{
							"lessThan": "89df95ce32be",
							"status": "affected",
							"version": "51f3baad7de9",
							"versionType": "git"
						},
						{
							"lessThan": "a115198caaab",
							"status": "affected",
							"version": "51f3baad7de9",
							"versionType": "git"
						},
						{
							"lessThan": "6f87c0e21ad2",
							"status": "affected",
							"version": "51f3baad7de9",
							"versionType": "git"
						},
						{
							"lessThan": "6bd3d80d1f01",
							"status": "affected",
							"version": "51f3baad7de9",
							"versionType": "git"
						},
						{
							"lessThan": "d0760a4ef856",
							"status": "affected",
							"version": "51f3baad7de9",
							"versionType": "git"
						},
						{
							"lessThan": "91c02557174b",
							"status": "affected",
							"version": "51f3baad7de9",
							"versionType": "git"
						}
					]
				},
				{
					"defaultStatus": "affected",
					"product": "Linux",
					"programFiles": [
						"drivers/net/can/usb/mcba_usb.c"
					],
					"repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
					"vendor": "Linux",
					"versions": [
						{
							"status": "affected",
							"version": "4.12"
						},
						{
							"lessThan": "4.12",
							"status": "unaffected",
							"version": "0",
							"versionType": "custom"
						},
						{
							"lessThanOrEqual": "4.14.*",
							"status": "unaffected",
							"version": "4.14.238",
							"versionType": "custom"
						},
						{
							"lessThanOrEqual": "4.19.*",
							"status": "unaffected",
							"version": "4.19.196",
							"versionType": "custom"
						},
						{
							"lessThanOrEqual": "5.4.*",
							"status": "unaffected",
							"version": "5.4.128",
							"versionType": "custom"
						},
						{
							"lessThanOrEqual": "5.10.*",
							"status": "unaffected",
							"version": "5.10.46",
							"versionType": "custom"
						},
						{
							"lessThanOrEqual": "5.12.*",
							"status": "unaffected",
							"version": "5.12.13",
							"versionType": "custom"
						},
						{
							"lessThanOrEqual": "*",
							"status": "unaffected",
							"version": "5.13",
							"versionType": "original_commit_for_fix"
						}
					]
				}
			],
			"descriptions": [
				{
					"lang": "en",
					"value": "In the Linux kernel, the following vulnerability has been resolved:\n\ncan: mcba_usb: fix memory leak in mcba_usb\n\nSyzbot reported memory leak in SocketCAN driver for Microchip CAN BUS\nAnalyzer Tool. The problem was in unfreed usb_coherent.\n\nIn mcba_usb_start() 20 coherent buffers are allocated and there is\nnothing, that frees them:\n\n1) In callback function the urb is resubmitted and that's all\n2) In disconnect function urbs are simply killed, but URB_FREE_BUFFER\n   is not set (see mcba_usb_start) and this flag cannot be used with\n   coherent buffers.\n\nFail log:\n| [ 1354.053291][ T8413] mcba_usb 1-1:0.0 can0: device disconnected\n| [ 1367.059384][ T8420] kmemleak: 20 new suspected memory leaks (see /sys/kernel/debug/kmem)\n\nSo, all allocated buffers should be freed with usb_free_coherent()\nexplicitly\n\nNOTE:\nThe same pattern for allocating and freeing coherent buffers\nis used in drivers/net/can/usb/kvaser_usb/kvaser_usb_core.c"
				}
			],
			"providerMetadata": {
				"dateUpdated": "2024-05-29T05:04:20.985Z",
				"orgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
				"shortName": "Linux"
			},
			"references": [
				{
					"url": "https://git.kernel.org/stable/c/89df95ce32be204eef2e7d4b2f6fb552fb191a68"
				},
				{
					"url": "https://git.kernel.org/stable/c/a115198caaab6d663bef75823a3c5f0802306d60"
				},
				{
					"url": "https://git.kernel.org/stable/c/6f87c0e21ad20dd3d22108e33db1c552dfa352a0"
				},
				{
					"url": "https://git.kernel.org/stable/c/6bd3d80d1f019cefa7011056c54b323f1d8b8e83"
				},
				{
					"url": "https://git.kernel.org/stable/c/d0760a4ef85697bc756d06eae17ae27f3f055401"
				},
				{
					"url": "https://git.kernel.org/stable/c/91c02557174be7f72e46ed7311e3bea1939840b0"
				}
			],
			"title": "can: mcba_usb: fix memory leak in mcba_usb",
			"x_generator": {
				"engine": "bippy-a5840b7849dd"
			}
		}
	}
}
