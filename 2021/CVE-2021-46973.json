{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.1",
	"cveMetadata": {
		"assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
		"assignerShortName": "Linux",
		"cveId": "CVE-2021-46973",
		"datePublished": "2024-02-27T18:47:07.880Z",
		"dateReserved": "2024-02-27T18:42:55.944Z",
		"dateUpdated": "2024-05-28T19:35:12.235Z",
		"state": "PUBLISHED"
	},
	"containers": {
		"cna": {
			"affected": [
				{
					"defaultStatus": "unaffected",
					"product": "Linux",
					"programFiles": [
						"net/qrtr/mhi.c"
					],
					"repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
					"vendor": "Linux",
					"versions": [
						{
							"lessThan": "48ec949ac979",
							"status": "affected",
							"version": "6e728f321393",
							"versionType": "git"
						},
						{
							"lessThan": "ea474054c2cc",
							"status": "affected",
							"version": "6e728f321393",
							"versionType": "git"
						},
						{
							"lessThan": "03c649dee8b1",
							"status": "affected",
							"version": "6e728f321393",
							"versionType": "git"
						},
						{
							"lessThan": "47a017f33943",
							"status": "affected",
							"version": "6e728f321393",
							"versionType": "git"
						}
					]
				},
				{
					"defaultStatus": "affected",
					"product": "Linux",
					"programFiles": [
						"net/qrtr/mhi.c"
					],
					"repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
					"vendor": "Linux",
					"versions": [
						{
							"status": "affected",
							"version": "5.8"
						},
						{
							"lessThan": "5.8",
							"status": "unaffected",
							"version": "0",
							"versionType": "custom"
						},
						{
							"lessThanOrEqual": "5.10.*",
							"status": "unaffected",
							"version": "5.10.35",
							"versionType": "custom"
						},
						{
							"lessThanOrEqual": "5.11.*",
							"status": "unaffected",
							"version": "5.11.19",
							"versionType": "custom"
						},
						{
							"lessThanOrEqual": "5.12.*",
							"status": "unaffected",
							"version": "5.12.2",
							"versionType": "custom"
						},
						{
							"lessThanOrEqual": "*",
							"status": "unaffected",
							"version": "5.13",
							"versionType": "original_commit_for_fix"
						}
					]
				}
			],
			"descriptions": [
				{
					"lang": "en",
					"value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnet: qrtr: Avoid potential use after free in MHI send\n\nIt is possible that the MHI ul_callback will be invoked immediately\nfollowing the queueing of the skb for transmission, leading to the\ncallback decrementing the refcount of the associated sk and freeing the\nskb.\n\nAs such the dereference of skb and the increment of the sk refcount must\nhappen before the skb is queued, to avoid the skb to be used after free\nand potentially the sk to drop its last refcount.."
				}
			],
			"providerMetadata": {
				"dateUpdated": "2024-05-28T19:35:12.235Z",
				"orgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
				"shortName": "Linux"
			},
			"references": [
				{
					"url": "https://git.kernel.org/stable/c/48ec949ac979b4b42d740f67b6177797af834f80"
				},
				{
					"url": "https://git.kernel.org/stable/c/ea474054c2cc6e1284604b21361f475c7cc8c0a0"
				},
				{
					"url": "https://git.kernel.org/stable/c/03c649dee8b1eb5600212a249542a70f47a5ab40"
				},
				{
					"url": "https://git.kernel.org/stable/c/47a017f33943278570c072bc71681809b2567b3a"
				}
			],
			"title": "net: qrtr: Avoid potential use after free in MHI send",
			"x_generator": {
				"engine": "bippy-a5840b7849dd"
			}
		}
	}
}
