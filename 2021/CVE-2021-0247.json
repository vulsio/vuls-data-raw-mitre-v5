{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.1",
	"cveMetadata": {
		"cveId": "CVE-2021-0247",
		"assignerOrgId": "8cbe9d5a-a066-4c94-8978-4b15efeae968",
		"assignerShortName": "juniper",
		"state": "PUBLISHED",
		"datePublished": "2021-04-14T00:00:00",
		"dateUpdated": "2024-08-03T15:32:10.255Z",
		"dateReserved": "2020-10-27T00:00:00"
	},
	"containers": {
		"cna": {
			"providerMetadata": {
				"orgID": "8cbe9d5a-a066-4c94-8978-4b15efeae968",
				"shortName": "juniper",
				"dateUpdated": "2021-04-22T19:37:10"
			},
			"title": "Junos OS: PTX Series, QFX Series: Due to a race condition input loopback firewall filters applied to interfaces may not operate even when listed in the running configuration.",
			"descriptions": [
				{
					"lang": "en",
					"value": "A Race Condition (Concurrent Execution using Shared Resource with Improper Synchronization) vulnerability in the firewall process (dfwd) of Juniper Networks Junos OS allows an attacker to bypass the firewall rule sets applied to the input loopback filter on any interfaces of a device. This issue is detectable by reviewing the PFE firewall rules, as well as the firewall counters and seeing if they are incrementing or not. For example: show firewall Filter: __default_bpdu_filter__ Filter: FILTER-INET-01 Counters: Name Bytes Packets output-match-inet 0 0 <<<<<< missing firewall packet count This issue affects: Juniper Networks Junos OS 14.1X53 versions prior to 14.1X53-D53 on QFX Series; 14.1 versions 14.1R1 and later versions prior to 15.1 versions prior to 15.1R7-S6 on QFX Series, PTX Series; 15.1X53 versions prior to 15.1X53-D593 on QFX Series; 16.1 versions prior to 16.1R7-S7 on QFX Series, PTX Series; 16.2 versions prior to 16.2R2-S11, 16.2R3 on QFX Series, PTX Series; 17.1 versions prior to 17.1R2-S11, 17.1R3-S2 on QFX Series, PTX Series; 17.2 versions prior to 17.2R1-S9, 17.2R3-S3 on QFX Series, PTX Series; 17.3 versions prior to 17.3R2-S5, 17.3R3-S7 on QFX Series, PTX Series; 17.4 versions prior to 17.4R2-S9, 17.4R3 on QFX Series, PTX Series; 18.1 versions prior to 18.1R3-S9 on QFX Series, PTX Series; 18.2 versions prior to 18.2R2-S6, 18.2R3-S3 on QFX Series, PTX Series; 18.3 versions prior to 18.3R1-S7, 18.3R2-S3, 18.3R3-S1 on QFX Series, PTX Series; 18.4 versions prior to 18.4R1-S5, 18.4R2-S3, 18.4R2-S7, 18.4R3 on QFX Series, PTX Series; 19.1 versions prior to 19.1R1-S4, 19.1R2-S1, 19.1R3 on QFX Series, PTX Series; 19.2 versions prior to 19.2R1-S3, 19.2R2 on QFX Series, PTX Series."
				}
			],
			"affected": [
				{
					"vendor": "Juniper Networks",
					"product": "Junos OS",
					"platforms": [
						"QFX Series"
					],
					"versions": [
						{
							"status": "affected",
							"versionType": "custom",
							"version": "14.1X53",
							"lessThan": "14.1X53-D53"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "15.1X53",
							"lessThan": "15.1X53-D593"
						}
					]
				},
				{
					"vendor": "Juniper Networks",
					"product": "Junos OS",
					"platforms": [
						"QFX Series, PTX Series"
					],
					"versions": [
						{
							"status": "affected",
							"versionType": "custom",
							"version": "14.1R1",
							"lessThan": "14.1*"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "15.1",
							"lessThan": "15.1R7-S6"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "16.1",
							"lessThan": "16.1R7-S7"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "16.2",
							"lessThan": "16.2R2-S11, 16.2R3"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "17.1",
							"lessThan": "17.1R2-S11, 17.1R3-S2"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "17.2",
							"lessThan": "17.2R1-S9, 17.2R3-S3"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "17.3",
							"lessThan": "17.3R2-S5, 17.3R3-S7"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "17.4",
							"lessThan": "17.4R2-S9, 17.4R3"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "18.1",
							"lessThan": "18.1R3-S9"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "18.2",
							"lessThan": "18.2R2-S6, 18.2R3-S3"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "18.3",
							"lessThan": "18.3R1-S7, 18.3R2-S3, 18.3R3-S1"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "18.4",
							"lessThan": "18.4R1-S5, 18.4R2-S3, 18.4R3"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "19.1",
							"lessThan": "19.1R1-S4, 19.1R2-S1, 19.1R3"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "19.2",
							"lessThan": "19.2R1-S3, 19.2R2"
						}
					]
				}
			],
			"problemTypes": [
				{
					"descriptions": [
						{
							"type": "CWE",
							"lang": "en",
							"description": "CWE-362 Race Condition (Concurrent Execution using Shared Resource with Improper Synchronization)",
							"cweId": "CWE-362"
						}
					]
				}
			],
			"metrics": [
				{
					"cvssV3_1": {
						"version": "3.1",
						"vectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:C/C:L/I:L/A:L",
						"attackVector": "NETWORK",
						"attackComplexity": "HIGH",
						"privilegesRequired": "HIGH",
						"userInteraction": "REQUIRED",
						"scope": "CHANGED",
						"confidentialityImpact": "LOW",
						"integrityImpact": "LOW",
						"availabilityImpact": "LOW",
						"baseScore": 5.1,
						"baseSeverity": "MEDIUM"
					}
				}
			],
			"workarounds": [
				{
					"lang": "en",
					"value": "There are no viable workarounds for this issue."
				}
			],
			"solutions": [
				{
					"lang": "en",
					"value": "The following software releases have been updated to resolve this specific issue: Junos OS 14.1X53-D53, 15.1R7-S6, 15.1X53-D593, 16.1R7-S7, 16.2R2-S11, 16.2R3, 17.1R2-S11, 17.1R3-S2, 17.2R1-S9, 17.2R3-S3, 17.3R2-S5, 17.3R3-S7, 17.4R2-S9, 17.4R3, 18.1R3-S9, 18.2R2-S6, 18.2R3-S3, 18.3R1-S7, 18.3R2-S3, 18.3R3-S1, 18.4R1-S5, 18.4R2-S3, 18.4R3, 19.1R1-S4, 19.1R2-S1, 19.1R3, 19.2R1-S3, 19.2R2, 19.3R1, and all subsequent releases.\n"
				}
			],
			"exploits": [
				{
					"lang": "en",
					"value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
				}
			],
			"configurations": [
				{
					"lang": "en",
					"value": "\nThis issue impact all filters families (inet, inet6, etc.) yet only on input loopback filters.\nIt does not does not rely upon the location where a filter is set, impacting both logical and physical interfaces. \n \nConfiguration examples for input filtering are posted on the support site and in product documentation. \n\n"
				}
			],
			"references": [
				{
					"tags": [
						"x_refsource_MISC"
					],
					"url": "https://kb.juniper.net/JSA11140"
				}
			],
			"source": {
				"advisory": "JSA11140",
				"defect": [
					"1430385"
				],
				"discovery": "USER"
			},
			"datePublic": "2021-04-14T00:00:00",
			"x_generator": {
				"engine": "Vulnogram 0.0.9"
			},
			"x_legacyV4Record": {
				"CVE_data_meta": {
					"ASSIGNER": "sirt@juniper.net",
					"DATE_PUBLIC": "2021-04-14T16:00:00.000Z",
					"ID": "CVE-2021-0247",
					"STATE": "PUBLIC",
					"TITLE": "Junos OS: PTX Series, QFX Series: Due to a race condition input loopback firewall filters applied to interfaces may not operate even when listed in the running configuration."
				},
				"affects": {
					"vendor": {
						"vendor_data": [
							{
								"product": {
									"product_data": [
										{
											"product_name": "Junos OS",
											"version": {
												"version_data": [
													{
														"platform": "QFX Series",
														"version_affected": "<",
														"version_name": "14.1X53",
														"version_value": "14.1X53-D53"
													},
													{
														"platform": "QFX Series, PTX Series",
														"version_affected": ">=",
														"version_name": "14.1",
														"version_value": "14.1R1"
													},
													{
														"platform": "QFX Series, PTX Series",
														"version_affected": "<",
														"version_name": "15.1",
														"version_value": "15.1R7-S6"
													},
													{
														"platform": "QFX Series",
														"version_affected": "<",
														"version_name": "15.1X53",
														"version_value": "15.1X53-D593"
													},
													{
														"platform": "QFX Series, PTX Series",
														"version_affected": "<",
														"version_name": "16.1",
														"version_value": "16.1R7-S7"
													},
													{
														"platform": "QFX Series, PTX Series",
														"version_affected": "<",
														"version_name": "16.2",
														"version_value": "16.2R2-S11, 16.2R3"
													},
													{
														"platform": "QFX Series, PTX Series",
														"version_affected": "<",
														"version_name": "17.1",
														"version_value": "17.1R2-S11, 17.1R3-S2"
													},
													{
														"platform": "QFX Series, PTX Series",
														"version_affected": "<",
														"version_name": "17.2",
														"version_value": "17.2R1-S9, 17.2R3-S3"
													},
													{
														"platform": "QFX Series, PTX Series",
														"version_affected": "<",
														"version_name": "17.3",
														"version_value": "17.3R2-S5, 17.3R3-S7"
													},
													{
														"platform": "QFX Series, PTX Series",
														"version_affected": "<",
														"version_name": "17.4",
														"version_value": "17.4R2-S9, 17.4R3"
													},
													{
														"platform": "QFX Series, PTX Series",
														"version_affected": "<",
														"version_name": "18.1",
														"version_value": "18.1R3-S9"
													},
													{
														"platform": "QFX Series, PTX Series",
														"version_affected": "<",
														"version_name": "18.2",
														"version_value": "18.2R2-S6, 18.2R3-S3"
													},
													{
														"platform": "QFX Series, PTX Series",
														"version_affected": "<",
														"version_name": "18.3",
														"version_value": "18.3R1-S7, 18.3R2-S3, 18.3R3-S1"
													},
													{
														"platform": "QFX Series, PTX Series",
														"version_affected": "<",
														"version_name": "18.4",
														"version_value": "18.4R1-S5, 18.4R2-S3, 18.4R3"
													},
													{
														"platform": "QFX Series, PTX Series",
														"version_affected": "<",
														"version_name": "19.1",
														"version_value": "19.1R1-S4, 19.1R2-S1, 19.1R3"
													},
													{
														"platform": "QFX Series, PTX Series",
														"version_affected": "<",
														"version_name": "19.2",
														"version_value": "19.2R1-S3, 19.2R2"
													}
												]
											}
										}
									]
								},
								"vendor_name": "Juniper Networks"
							}
						]
					}
				},
				"configuration": [
					{
						"lang": "en",
						"value": "\nThis issue impact all filters families (inet, inet6, etc.) yet only on input loopback filters.\nIt does not does not rely upon the location where a filter is set, impacting both logical and physical interfaces. \n \nConfiguration examples for input filtering are posted on the support site and in product documentation. \n\n"
					}
				],
				"data_format": "MITRE",
				"data_type": "CVE",
				"data_version": "4.0",
				"description": {
					"description_data": [
						{
							"lang": "eng",
							"value": "A Race Condition (Concurrent Execution using Shared Resource with Improper Synchronization) vulnerability in the firewall process (dfwd) of Juniper Networks Junos OS allows an attacker to bypass the firewall rule sets applied to the input loopback filter on any interfaces of a device. This issue is detectable by reviewing the PFE firewall rules, as well as the firewall counters and seeing if they are incrementing or not. For example: show firewall Filter: __default_bpdu_filter__ Filter: FILTER-INET-01 Counters: Name Bytes Packets output-match-inet 0 0 <<<<<< missing firewall packet count This issue affects: Juniper Networks Junos OS 14.1X53 versions prior to 14.1X53-D53 on QFX Series; 14.1 versions 14.1R1 and later versions prior to 15.1 versions prior to 15.1R7-S6 on QFX Series, PTX Series; 15.1X53 versions prior to 15.1X53-D593 on QFX Series; 16.1 versions prior to 16.1R7-S7 on QFX Series, PTX Series; 16.2 versions prior to 16.2R2-S11, 16.2R3 on QFX Series, PTX Series; 17.1 versions prior to 17.1R2-S11, 17.1R3-S2 on QFX Series, PTX Series; 17.2 versions prior to 17.2R1-S9, 17.2R3-S3 on QFX Series, PTX Series; 17.3 versions prior to 17.3R2-S5, 17.3R3-S7 on QFX Series, PTX Series; 17.4 versions prior to 17.4R2-S9, 17.4R3 on QFX Series, PTX Series; 18.1 versions prior to 18.1R3-S9 on QFX Series, PTX Series; 18.2 versions prior to 18.2R2-S6, 18.2R3-S3 on QFX Series, PTX Series; 18.3 versions prior to 18.3R1-S7, 18.3R2-S3, 18.3R3-S1 on QFX Series, PTX Series; 18.4 versions prior to 18.4R1-S5, 18.4R2-S3, 18.4R2-S7, 18.4R3 on QFX Series, PTX Series; 19.1 versions prior to 19.1R1-S4, 19.1R2-S1, 19.1R3 on QFX Series, PTX Series; 19.2 versions prior to 19.2R1-S3, 19.2R2 on QFX Series, PTX Series."
						}
					]
				},
				"exploit": [
					{
						"lang": "en",
						"value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
					}
				],
				"generator": {
					"engine": "Vulnogram 0.0.9"
				},
				"impact": {
					"cvss": {
						"attackComplexity": "HIGH",
						"attackVector": "NETWORK",
						"availabilityImpact": "LOW",
						"baseScore": 5.1,
						"baseSeverity": "MEDIUM",
						"confidentialityImpact": "LOW",
						"integrityImpact": "LOW",
						"privilegesRequired": "HIGH",
						"scope": "CHANGED",
						"userInteraction": "REQUIRED",
						"vectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:C/C:L/I:L/A:L",
						"version": "3.1"
					}
				},
				"problemtype": {
					"problemtype_data": [
						{
							"description": [
								{
									"lang": "eng",
									"value": "CWE-362 Race Condition (Concurrent Execution using Shared Resource with Improper Synchronization)"
								}
							]
						}
					]
				},
				"references": {
					"reference_data": [
						{
							"name": "https://kb.juniper.net/JSA11140",
							"refsource": "MISC",
							"url": "https://kb.juniper.net/JSA11140"
						}
					]
				},
				"solution": [
					{
						"lang": "en",
						"value": "The following software releases have been updated to resolve this specific issue: Junos OS 14.1X53-D53, 15.1R7-S6, 15.1X53-D593, 16.1R7-S7, 16.2R2-S11, 16.2R3, 17.1R2-S11, 17.1R3-S2, 17.2R1-S9, 17.2R3-S3, 17.3R2-S5, 17.3R3-S7, 17.4R2-S9, 17.4R3, 18.1R3-S9, 18.2R2-S6, 18.2R3-S3, 18.3R1-S7, 18.3R2-S3, 18.3R3-S1, 18.4R1-S5, 18.4R2-S3, 18.4R3, 19.1R1-S4, 19.1R2-S1, 19.1R3, 19.2R1-S3, 19.2R2, 19.3R1, and all subsequent releases.\n"
					}
				],
				"source": {
					"advisory": "JSA11140",
					"defect": [
						"1430385"
					],
					"discovery": "USER"
				},
				"work_around": [
					{
						"lang": "en",
						"value": "There are no viable workarounds for this issue."
					}
				]
			}
		},
		"adp": [
			{
				"providerMetadata": {
					"orgID": "af854a3a-2127-422b-91ae-364da2661108",
					"shortName": "CVE",
					"dateUpdated": "2024-08-03T15:32:10.255Z"
				},
				"title": "CVE Program Container",
				"references": [
					{
						"tags": [
							"x_refsource_MISC",
							"x_transferred"
						],
						"url": "https://kb.juniper.net/JSA11140"
					}
				]
			}
		]
	}
}
