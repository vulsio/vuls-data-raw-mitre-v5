{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.1",
	"cveMetadata": {
		"cveId": "CVE-2021-0217",
		"assignerOrgId": "8cbe9d5a-a066-4c94-8978-4b15efeae968",
		"assignerShortName": "juniper",
		"state": "PUBLISHED",
		"datePublished": "2021-01-15T17:35:59.456240Z",
		"dateUpdated": "2024-09-17T02:06:21.940Z",
		"dateReserved": "2020-10-27T00:00:00"
	},
	"containers": {
		"cna": {
			"providerMetadata": {
				"orgID": "8cbe9d5a-a066-4c94-8978-4b15efeae968",
				"shortName": "juniper",
				"dateUpdated": "2021-01-15T17:35:59"
			},
			"title": "Junos OS: EX Series and QFX Series: Memory leak issue processing specific DHCP packets",
			"descriptions": [
				{
					"lang": "en",
					"value": "A vulnerability in processing of certain DHCP packets from adjacent clients on EX Series and QFX Series switches running Juniper Networks Junos OS with DHCP local/relay server configured may lead to exhaustion of DMA memory causing a Denial of Service (DoS). Over time, exploitation of this vulnerability may cause traffic to stop being forwarded, or to crashing of the fxpc process. When Packet DMA heap utilization reaches 99%, the system will become unstable. Packet DMA heap utilization can be monitored through the following command: user@junos# request pfe execute target fpc0 timeout 30 command \"show heap\" ID Base Total(b) Free(b) Used(b) % Name -- ---------- ----------- ----------- ----------- --- ----------- 0 213301a8 536870488 387228840 149641648 27 Kernel 1 91800000 8388608 3735120 4653488 55 DMA 2 92000000 75497472 74452192 1045280 1 PKT DMA DESC 3 d330000 335544320 257091400 78452920 23 Bcm_sdk 4 96800000 184549376 2408 184546968 99 Packet DMA <--- 5 903fffe0 20971504 20971504 0 0 Blob An indication of the issue occurring may be observed through the following log messages: Dec 10 08:07:00.124 2020 hostname fpc0 brcm_pkt_buf_alloc:523 (buf alloc) failed allocating packet buffer Dec 10 08:07:00.126 2020 hostname fpc0 (buf alloc) failed allocating packet buffer Dec 10 08:07:00.128 2020 hostname fpc0 brcm_pkt_buf_alloc:523 (buf alloc) failed allocating packet buffer Dec 10 08:07:00.130 2020 hostnameC fpc0 (buf alloc) failed allocating packet buffer This issue affects Juniper Networks Junos OS on EX Series and QFX Series: 17.4R3 versions prior to 17.4R3-S3; 18.1R3 versions between 18.1R3-S6 and 18.1R3-S11; 18.2R3 versions prior to 18.2R3-S6; 18.3R3 versions prior to 18.3R3-S4; 18.4R2 versions prior to 18.4R2-S5; 18.4R3 versions prior to 18.4R3-S6; 19.1 versions between 19.1R2 and 19.1R3-S3; 19.2 versions prior to 19.2R3-S1; 19.3 versions prior to 19.3R2-S5, 19.3R3; 19.4 versions prior to 19.4R2-S2, 19.4R3; 20.1 versions prior to 20.1R2; 20.2 versions prior to 20.2R1-S2, 20.2R2. Junos OS versions prior to 17.4R3 are unaffected by this vulnerability."
				}
			],
			"affected": [
				{
					"vendor": "Juniper Networks",
					"product": "Junos OS",
					"platforms": [
						"EX Series, QFX Series"
					],
					"versions": [
						{
							"status": "unaffected",
							"versionType": "custom",
							"version": "unspecified",
							"lessThan": "17.4R3"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "17.4",
							"lessThan": "17.4R3-S3"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "18.1R3-S6",
							"lessThan": "18.1*",
							"changes": [
								{
									"at": "18.1R3-S11",
									"status": "unaffected"
								}
							]
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "18.2R3",
							"lessThan": "18.2*",
							"changes": [
								{
									"at": "18.2R3-S6",
									"status": "unaffected"
								}
							]
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "18.3R3",
							"lessThan": "18.3*",
							"changes": [
								{
									"at": "18.3R3-S4",
									"status": "unaffected"
								}
							]
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "18.4R2",
							"lessThan": "18.4*",
							"changes": [
								{
									"at": "18.4R3",
									"status": "affected"
								},
								{
									"at": "18.4R2-S5, 18.4R3-S6",
									"status": "unaffected"
								}
							]
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "19.1R2",
							"lessThan": "19.1*",
							"changes": [
								{
									"at": "19.1R3-S3",
									"status": "unaffected"
								}
							]
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "19.2",
							"lessThan": "19.2R3-S1"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "19.3",
							"lessThan": "19.3R2-S5, 19.3R3"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "19.4",
							"lessThan": "19.4R2-S2, 19.4R3"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "20.1",
							"lessThan": "20.1R2"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "20.2",
							"lessThan": "20.2R1-S2, 20.2R2"
						}
					]
				}
			],
			"problemTypes": [
				{
					"descriptions": [
						{
							"type": "CWE",
							"lang": "en",
							"description": "CWE-119 Improper Restriction of Operations within the Bounds of a Memory Buffer",
							"cweId": "CWE-119"
						}
					]
				}
			],
			"metrics": [
				{
					"cvssV3_1": {
						"version": "3.1",
						"vectorString": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H",
						"attackVector": "ADJACENT_NETWORK",
						"attackComplexity": "LOW",
						"privilegesRequired": "NONE",
						"userInteraction": "NONE",
						"scope": "CHANGED",
						"confidentialityImpact": "NONE",
						"integrityImpact": "NONE",
						"availabilityImpact": "HIGH",
						"baseScore": 7.4,
						"baseSeverity": "HIGH"
					}
				}
			],
			"workarounds": [
				{
					"lang": "en",
					"value": "There are no available workarounds for this issue."
				}
			],
			"solutions": [
				{
					"lang": "en",
					"value": "The following software releases have been updated to resolve this specific issue: Junos OS 17.4R3-S3, 18.1R3-S11, 18.2R3-S6, 18.3R3-S4, 18.4R2-S5, 18.4R2-S7, 18.4R3-S6, 19.1R1-S6, 19.1R3-S3, 19.2R3-S1, 19.3R2-S5, 19.3R3, 19.4R2-S2, 19.4R3, 20.1R2, 20.2R1-S2, 20.2R2, 20.3R1, and all subsequent releases."
				}
			],
			"exploits": [
				{
					"lang": "en",
					"value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
				}
			],
			"configurations": [
				{
					"lang": "en",
					"value": "The following configuration snippet enables the DHCP relay forwarding option:\n\n  [forwarding-options dhcp-relay]"
				}
			],
			"references": [
				{
					"tags": [
						"x_refsource_CONFIRM"
					],
					"url": "https://kb.juniper.net/JSA11107"
				}
			],
			"source": {
				"advisory": "JSA11107",
				"defect": [
					"1514145"
				],
				"discovery": "USER"
			},
			"datePublic": "2021-01-13T00:00:00",
			"x_generator": {
				"engine": "Vulnogram 0.0.9"
			},
			"x_legacyV4Record": {
				"CVE_data_meta": {
					"ASSIGNER": "sirt@juniper.net",
					"DATE_PUBLIC": "2021-01-13T17:00:00.000Z",
					"ID": "CVE-2021-0217",
					"STATE": "PUBLIC",
					"TITLE": "Junos OS: EX Series and QFX Series: Memory leak issue processing specific DHCP packets"
				},
				"affects": {
					"vendor": {
						"vendor_data": [
							{
								"product": {
									"product_data": [
										{
											"product_name": "Junos OS",
											"version": {
												"version_data": [
													{
														"platform": "EX Series, QFX Series",
														"version_affected": "!<",
														"version_value": "17.4R3"
													},
													{
														"platform": "EX Series, QFX Series",
														"version_affected": "<",
														"version_name": "17.4",
														"version_value": "17.4R3-S3"
													},
													{
														"platform": "EX Series, QFX Series",
														"version_affected": ">=",
														"version_name": "18.1",
														"version_value": "18.1R3-S6"
													},
													{
														"platform": "EX Series, QFX Series",
														"version_affected": "<",
														"version_name": "18.1",
														"version_value": "18.1R3-S11"
													},
													{
														"platform": "EX Series, QFX Series",
														"version_affected": ">=",
														"version_name": "18.2",
														"version_value": "18.2R3"
													},
													{
														"platform": "EX Series, QFX Series",
														"version_affected": "<",
														"version_name": "18.2",
														"version_value": "18.2R3-S6"
													},
													{
														"platform": "EX Series, QFX Series",
														"version_affected": ">=",
														"version_name": "18.3",
														"version_value": "18.3R3"
													},
													{
														"platform": "EX Series, QFX Series",
														"version_affected": "<",
														"version_name": "18.3",
														"version_value": "18.3R3-S4"
													},
													{
														"platform": "EX Series, QFX Series",
														"version_affected": ">=",
														"version_name": "18.4",
														"version_value": "18.4R2"
													},
													{
														"platform": "EX Series, QFX Series",
														"version_affected": ">=",
														"version_name": "18.4",
														"version_value": "18.4R3"
													},
													{
														"platform": "EX Series, QFX Series",
														"version_affected": "<",
														"version_name": "18.4",
														"version_value": "18.4R2-S5, 18.4R3-S6"
													},
													{
														"platform": "EX Series, QFX Series",
														"version_affected": ">=",
														"version_name": "19.1",
														"version_value": "19.1R2"
													},
													{
														"platform": "EX Series, QFX Series",
														"version_affected": "<",
														"version_name": "19.1",
														"version_value": "19.1R3-S3"
													},
													{
														"platform": "EX Series, QFX Series",
														"version_affected": "<",
														"version_name": "19.2",
														"version_value": "19.2R3-S1"
													},
													{
														"platform": "EX Series, QFX Series",
														"version_affected": "<",
														"version_name": "19.3",
														"version_value": "19.3R2-S5, 19.3R3"
													},
													{
														"platform": "EX Series, QFX Series",
														"version_affected": "<",
														"version_name": "19.4",
														"version_value": "19.4R2-S2, 19.4R3"
													},
													{
														"platform": "EX Series, QFX Series",
														"version_affected": "<",
														"version_name": "20.1",
														"version_value": "20.1R2"
													},
													{
														"platform": "EX Series, QFX Series",
														"version_affected": "<",
														"version_name": "20.2",
														"version_value": "20.2R1-S2, 20.2R2"
													}
												]
											}
										}
									]
								},
								"vendor_name": "Juniper Networks"
							}
						]
					}
				},
				"configuration": [
					{
						"lang": "en",
						"value": "The following configuration snippet enables the DHCP relay forwarding option:\n\n  [forwarding-options dhcp-relay]"
					}
				],
				"data_format": "MITRE",
				"data_type": "CVE",
				"data_version": "4.0",
				"description": {
					"description_data": [
						{
							"lang": "eng",
							"value": "A vulnerability in processing of certain DHCP packets from adjacent clients on EX Series and QFX Series switches running Juniper Networks Junos OS with DHCP local/relay server configured may lead to exhaustion of DMA memory causing a Denial of Service (DoS). Over time, exploitation of this vulnerability may cause traffic to stop being forwarded, or to crashing of the fxpc process. When Packet DMA heap utilization reaches 99%, the system will become unstable. Packet DMA heap utilization can be monitored through the following command: user@junos# request pfe execute target fpc0 timeout 30 command \"show heap\" ID Base Total(b) Free(b) Used(b) % Name -- ---------- ----------- ----------- ----------- --- ----------- 0 213301a8 536870488 387228840 149641648 27 Kernel 1 91800000 8388608 3735120 4653488 55 DMA 2 92000000 75497472 74452192 1045280 1 PKT DMA DESC 3 d330000 335544320 257091400 78452920 23 Bcm_sdk 4 96800000 184549376 2408 184546968 99 Packet DMA <--- 5 903fffe0 20971504 20971504 0 0 Blob An indication of the issue occurring may be observed through the following log messages: Dec 10 08:07:00.124 2020 hostname fpc0 brcm_pkt_buf_alloc:523 (buf alloc) failed allocating packet buffer Dec 10 08:07:00.126 2020 hostname fpc0 (buf alloc) failed allocating packet buffer Dec 10 08:07:00.128 2020 hostname fpc0 brcm_pkt_buf_alloc:523 (buf alloc) failed allocating packet buffer Dec 10 08:07:00.130 2020 hostnameC fpc0 (buf alloc) failed allocating packet buffer This issue affects Juniper Networks Junos OS on EX Series and QFX Series: 17.4R3 versions prior to 17.4R3-S3; 18.1R3 versions between 18.1R3-S6 and 18.1R3-S11; 18.2R3 versions prior to 18.2R3-S6; 18.3R3 versions prior to 18.3R3-S4; 18.4R2 versions prior to 18.4R2-S5; 18.4R3 versions prior to 18.4R3-S6; 19.1 versions between 19.1R2 and 19.1R3-S3; 19.2 versions prior to 19.2R3-S1; 19.3 versions prior to 19.3R2-S5, 19.3R3; 19.4 versions prior to 19.4R2-S2, 19.4R3; 20.1 versions prior to 20.1R2; 20.2 versions prior to 20.2R1-S2, 20.2R2. Junos OS versions prior to 17.4R3 are unaffected by this vulnerability."
						}
					]
				},
				"exploit": [
					{
						"lang": "en",
						"value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability."
					}
				],
				"generator": {
					"engine": "Vulnogram 0.0.9"
				},
				"impact": {
					"cvss": {
						"attackComplexity": "LOW",
						"attackVector": "ADJACENT_NETWORK",
						"availabilityImpact": "HIGH",
						"baseScore": 7.4,
						"baseSeverity": "HIGH",
						"confidentialityImpact": "NONE",
						"integrityImpact": "NONE",
						"privilegesRequired": "NONE",
						"scope": "CHANGED",
						"userInteraction": "NONE",
						"vectorString": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:H",
						"version": "3.1"
					}
				},
				"problemtype": {
					"problemtype_data": [
						{
							"description": [
								{
									"lang": "eng",
									"value": "CWE-119 Improper Restriction of Operations within the Bounds of a Memory Buffer"
								}
							]
						}
					]
				},
				"references": {
					"reference_data": [
						{
							"name": "https://kb.juniper.net/JSA11107",
							"refsource": "CONFIRM",
							"url": "https://kb.juniper.net/JSA11107"
						}
					]
				},
				"solution": [
					{
						"lang": "en",
						"value": "The following software releases have been updated to resolve this specific issue: Junos OS 17.4R3-S3, 18.1R3-S11, 18.2R3-S6, 18.3R3-S4, 18.4R2-S5, 18.4R2-S7, 18.4R3-S6, 19.1R1-S6, 19.1R3-S3, 19.2R3-S1, 19.3R2-S5, 19.3R3, 19.4R2-S2, 19.4R3, 20.1R2, 20.2R1-S2, 20.2R2, 20.3R1, and all subsequent releases."
					}
				],
				"source": {
					"advisory": "JSA11107",
					"defect": [
						"1514145"
					],
					"discovery": "USER"
				},
				"work_around": [
					{
						"lang": "en",
						"value": "There are no available workarounds for this issue."
					}
				]
			}
		},
		"adp": [
			{
				"providerMetadata": {
					"orgID": "af854a3a-2127-422b-91ae-364da2661108",
					"shortName": "CVE",
					"dateUpdated": "2024-08-03T15:32:10.314Z"
				},
				"title": "CVE Program Container",
				"references": [
					{
						"tags": [
							"x_refsource_CONFIRM",
							"x_transferred"
						],
						"url": "https://kb.juniper.net/JSA11107"
					}
				]
			}
		]
	}
}
