{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.1",
	"cveMetadata": {
		"cveId": "CVE-2023-3823",
		"assignerOrgId": "dd77f84a-d19a-4638-8c3d-a322d820ed2b",
		"assignerShortName": "php",
		"state": "PUBLISHED",
		"datePublished": "2023-08-11T05:42:25.771Z",
		"dateUpdated": "2024-08-02T07:08:50.269Z",
		"dateReserved": "2023-07-21T16:16:57.133Z"
	},
	"containers": {
		"cna": {
			"providerMetadata": {
				"orgID": "dd77f84a-d19a-4638-8c3d-a322d820ed2b",
				"shortName": "php",
				"dateUpdated": "2023-08-11T05:42:25.771Z"
			},
			"title": "Security issue with external entity loading in XML without enabling it",
			"descriptions": [
				{
					"lang": "en",
					"value": "In PHP versions 8.0.* before 8.0.30, 8.1.* before 8.1.22, and 8.2.* before 8.2.8 various XML functions rely on libxml global state to track configuration variables, like whether external entities are loaded. This state is assumed to be unchanged unless the user explicitly changes it by calling appropriate function. However, since the state is process-global, other modules - such as ImageMagick - may also use this library within the same process, and change that global state for their internal purposes, and leave it in a state where external entities loading is enabled. This can lead to the situation where external XML is parsed with external entities loaded, which can lead to disclosure of any local files accessible to PHP. This vulnerable state may persist in the same process across many requests, until the process is shut down. \n\n",
					"supportingMedia": [
						{
							"type": "text/html",
							"base64": false,
							"value": "<p>In PHP versions 8.0.* before 8.0.30, 8.1.* before 8.1.22, and 8.2.* before 8.2.8 various XML functions rely on libxml global state to track configuration variables, like whether external entities are loaded. This state is assumed to be unchanged unless the user explicitly changes it by calling appropriate function. However, since the state is process-global, other modules - such as&nbsp;<span style=\"background-color: rgb(255, 255, 255);\">ImageMagick - may also use this library within the same process, and change that global state for their internal purposes, and leave it in a state where external entities loading is enabled. This can lead to the situation where external XML is parsed with external entities loaded, which can lead to disclosure of any local files accessible to PHP. This vulnerable state may persist in the same process across many requests, until the process is shut down.&nbsp;</span></p>"
						}
					]
				}
			],
			"affected": [
				{
					"vendor": "PHP Group",
					"product": "PHP",
					"defaultStatus": "affected",
					"versions": [
						{
							"status": "affected",
							"versionType": "semver",
							"version": "8.0.*",
							"lessThan": "8.0.30"
						},
						{
							"status": "affected",
							"versionType": "semver",
							"version": "8.1.*",
							"lessThan": "8.1.22"
						},
						{
							"status": "affected",
							"versionType": "semver",
							"version": "8.2.*",
							"lessThan": "8.2.8"
						}
					]
				}
			],
			"impacts": [
				{
					"descriptions": [
						{
							"lang": "en",
							"value": "CAPEC-197 XML Entity Expansion"
						}
					],
					"capecId": "CAPEC-197"
				}
			],
			"metrics": [
				{
					"format": "CVSS",
					"scenarios": [
						{
							"lang": "en",
							"value": "GENERAL"
						}
					],
					"cvssV3_1": {
						"version": "3.1",
						"vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:L",
						"attackVector": "NETWORK",
						"attackComplexity": "LOW",
						"privilegesRequired": "NONE",
						"userInteraction": "NONE",
						"scope": "UNCHANGED",
						"confidentialityImpact": "HIGH",
						"integrityImpact": "LOW",
						"availabilityImpact": "LOW",
						"baseScore": 8.6,
						"baseSeverity": "HIGH"
					}
				}
			],
			"workarounds": [
				{
					"lang": "en",
					"value": "Disable external entity loader, e.g. like this: libxml_set_external_entity_loader(function () { return null; });\n\n\n",
					"supportingMedia": [
						{
							"type": "text/html",
							"base64": false,
							"value": "Disable external entity loader, e.g. like this:&nbsp;<pre>libxml_set_external_entity_loader(function () { return null; });</pre><br>"
						}
					]
				}
			],
			"references": [
				{
					"url": "https://github.com/php/php-src/security/advisories/GHSA-3qrf-m4j2-pcrr"
				},
				{
					"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/7NBF77WN6DTVTY2RE73IGPYD6M4PIAWA/"
				},
				{
					"url": "https://security.netapp.com/advisory/ntap-20230825-0001/"
				},
				{
					"url": "https://lists.debian.org/debian-lts-announce/2023/09/msg00002.html"
				}
			],
			"credits": [
				{
					"type": "reporter",
					"lang": "en",
					"user": "00000000-0000-4000-9000-000000000000",
					"value": "Joas Schilling"
				}
			],
			"source": {
				"advisory": "https://github.com/php/php-src/security/advisories/GHSA-3qrf-m4j",
				"discovery": "EXTERNAL"
			},
			"datePublic": "2023-08-05T04:00:00.000Z",
			"x_generator": {
				"engine": "Vulnogram 0.1.0-dev"
			}
		},
		"adp": [
			{
				"providerMetadata": {
					"orgID": "af854a3a-2127-422b-91ae-364da2661108",
					"shortName": "CVE",
					"dateUpdated": "2024-08-02T07:08:50.269Z"
				},
				"title": "CVE Program Container",
				"references": [
					{
						"tags": [
							"x_transferred"
						],
						"url": "https://github.com/php/php-src/security/advisories/GHSA-3qrf-m4j2-pcrr"
					},
					{
						"tags": [
							"x_transferred"
						],
						"url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/7NBF77WN6DTVTY2RE73IGPYD6M4PIAWA/"
					},
					{
						"tags": [
							"x_transferred"
						],
						"url": "https://security.netapp.com/advisory/ntap-20230825-0001/"
					},
					{
						"tags": [
							"x_transferred"
						],
						"url": "https://lists.debian.org/debian-lts-announce/2023/09/msg00002.html"
					}
				]
			}
		]
	}
}
