{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.1",
	"cveMetadata": {
		"cveId": "CVE-2023-5123",
		"assignerOrgId": "57da9224-a3e2-4646-9d0e-c4dc2e05e7da",
		"assignerShortName": "GRAFANA",
		"state": "PUBLISHED",
		"datePublished": "2024-02-14T15:06:11.126Z",
		"dateUpdated": "2024-06-18T09:26:49.158Z",
		"dateReserved": "2023-09-22T14:37:00.387Z"
	},
	"containers": {
		"cna": {
			"providerMetadata": {
				"orgID": "57da9224-a3e2-4646-9d0e-c4dc2e05e7da",
				"shortName": "GRAFANA",
				"dateUpdated": "2024-06-18T09:26:49.158Z"
			},
			"title": "Improper Path Sanitization in JSON Datasource Plugin",
			"descriptions": [
				{
					"lang": "en",
					"value": "The JSON datasource plugin ( https://grafana.com/grafana/plugins/marcusolsson-json-datasource/ ) is a Grafana Labs maintained plugin for Grafana that allows for retrieving and processing JSON data from a remote endpoint (including a specific sub-path) configured by an administrator. Due to inadequate sanitization of the dashboard-supplied path parameter, it was possible to include path traversal characters (../) in the path parameter and send requests to paths on the configured endpoint outside the configured sub-path. \n\n\n\n\n\n    \n    \n            \n\n\n\n\n\n\n    \n    \n            This means that if the datasource was configured by an administrator to point at some sub-path of a domain (e.g.  https://example.com/api/some_safe_api/ ), it was possible for an editor to create a dashboard referencing the datasource which issues queries containing path traversal characters, which would in turn cause the datasource to instead query arbitrary subpaths on the configured domain (e.g.  https://example.com/api/admin_api/) .\n\nIn the rare case that this plugin is configured by an administrator to point back at the Grafana instance itself, this vulnerability becomes considerably more severe, as an administrator browsing a maliciously configured panel could be compelled to make requests to Grafana administrative API endpoints with their credentials, resulting in the potential for privilege escalation, hence the high score for this vulnerability.",
					"supportingMedia": [
						{
							"type": "text/html",
							"base64": false,
							"value": "<table><tbody><tr><td>The JSON datasource plugin (<a target=\"_blank\" rel=\"nofollow\" href=\"https://grafana.com/grafana/plugins/marcusolsson-json-datasource/\">https://grafana.com/grafana/plugins/marcusolsson-json-datasource/</a>) is a Grafana Labs maintained plugin for Grafana that allows for retrieving and processing JSON data from a remote endpoint (including a specific sub-path) configured by an administrator. Due to inadequate sanitization of the dashboard-supplied path parameter, it was possible to include path traversal characters (../) in the path parameter and send requests to paths on the configured endpoint outside the configured sub-path. </td>\n</tr>\n\n\n\n\n    <tr>\n    </tr></tbody></table>\n        <table><tbody><tr><td>    <br></td>\n</tr>\n\n\n\n\n    <tr>\n    </tr></tbody></table>\n            This means that if the datasource was configured by an administrator to point at some sub-path of a domain (e.g. <a target=\"_blank\" rel=\"nofollow\" href=\"https://example.com/api/some_safe_api/\">https://example.com/api/some_safe_api/</a>), it was possible for an editor to create a dashboard referencing the datasource which issues queries containing path traversal characters, which would in turn cause the datasource to instead query arbitrary subpaths on the configured domain (e.g. <a target=\"_blank\" rel=\"nofollow\" href=\"https://example.com/api/admin_api/)\">https://example.com/api/admin_api/)</a>.<br><br>In the rare case that this plugin is configured by an administrator to point back at the Grafana instance itself, this vulnerability becomes considerably more severe, as an administrator browsing a maliciously configured panel could be compelled to make requests to Grafana administrative API endpoints with their credentials, resulting in the potential for privilege escalation, hence the high score for this vulnerability.<br>"
						}
					]
				}
			],
			"affected": [
				{
					"vendor": "Grafana",
					"product": "grafana-json-datasource",
					"repo": "https://github.com/grafana/grafana-json-datasource",
					"defaultStatus": "unaffected",
					"versions": [
						{
							"status": "affected",
							"versionType": "semver",
							"version": "0.2.0",
							"lessThan": "1.3.16"
						}
					]
				}
			],
			"problemTypes": [
				{
					"descriptions": [
						{
							"type": "CWE",
							"lang": "en",
							"description": "CWE-22 Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal')",
							"cweId": "CWE-22"
						}
					]
				}
			],
			"impacts": [
				{
					"descriptions": [
						{
							"lang": "en",
							"value": "CAPEC-126 Path Traversal"
						}
					],
					"capecId": "CAPEC-126"
				}
			],
			"metrics": [
				{
					"format": "CVSS",
					"scenarios": [
						{
							"lang": "en",
							"value": "GENERAL"
						}
					],
					"cvssV3_1": {
						"version": "3.1",
						"vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H",
						"attackVector": "NETWORK",
						"attackComplexity": "LOW",
						"privilegesRequired": "LOW",
						"userInteraction": "REQUIRED",
						"scope": "UNCHANGED",
						"confidentialityImpact": "HIGH",
						"integrityImpact": "HIGH",
						"availabilityImpact": "HIGH",
						"baseScore": 8,
						"baseSeverity": "HIGH"
					}
				}
			],
			"configurations": [
				{
					"lang": "en",
					"value": "To be exposed to the full risk of this vulnerability, an administrator must have installed this plugin and configured it to send requests back to the Grafana API, with a subpath constraint set to prevent requests to administrative API endpoints.",
					"supportingMedia": [
						{
							"type": "text/html",
							"base64": false,
							"value": "To be exposed to the full risk of this vulnerability, an administrator must have installed this plugin and configured it to send requests back to the Grafana API, with a subpath constraint set to prevent requests to administrative API endpoints.<br>"
						}
					]
				}
			],
			"references": [
				{
					"url": "https://grafana.com/security/security-advisories/cve-2023-5123/"
				},
				{
					"url": "https://security.netapp.com/advisory/ntap-20240503-0007/"
				}
			],
			"source": {
				"discovery": "UNKNOWN"
			},
			"x_generator": {
				"engine": "Vulnogram 0.1.0-dev"
			}
		}
	}
}
