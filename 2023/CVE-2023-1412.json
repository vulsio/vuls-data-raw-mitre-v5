{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.0",
	"cveMetadata": {
		"cveId": "CVE-2023-1412",
		"assignerOrgId": "a22f1246-ba21-4bb4-a601-ad51614c1513",
		"assignerShortName": "cloudflare",
		"state": "PUBLISHED",
		"datePublished": "2023-04-05T15:22:56.317Z",
		"dateUpdated": "2023-04-05T15:22:56.317Z",
		"dateReserved": "2023-03-15T13:33:23.768Z"
	},
	"containers": {
		"cna": {
			"providerMetadata": {
				"orgID": "a22f1246-ba21-4bb4-a601-ad51614c1513",
				"shortName": "cloudflare",
				"dateUpdated": "2023-04-05T15:22:56.317Z"
			},
			"title": "Local Privilege Escalation Vulnerability in WARP's MSI Installer",
			"descriptions": [
				{
					"lang": "en",
					"value": "An unprivileged (non-admin) user can exploit an Improper Access Control vulnerability in the Cloudflare WARP Client for Windows (<= 2022.12.582.0) to perform privileged operations with SYSTEM context by working with a combination of opportunistic locks (oplock) and symbolic links (which can both be created by an unprivileged user).\n\nAfter installing the Cloudflare WARP Client (admin privileges required), an MSI-Installer is placed under C:\\Windows\\Installer. The vulnerability lies in the repair function of this MSI.\n\nImpactAn unprivileged (non-admin) user can exploit this vulnerability to perform privileged operations with SYSTEM context, including deleting arbitrary files and reading arbitrary file content. This can lead to a variety of attacks, including the manipulation of system files and privilege escalation.\n\nPatchesA new installer with a fix that addresses this vulnerability was released in version 2023.3.381.0. While the WARP Client itself is not vulnerable (only the installer), users are encouraged to upgrade to the latest version and delete any older installers present in their systems.\n\n\n\n\n",
					"supportingMedia": [
						{
							"type": "text/html",
							"base64": false,
							"value": "<p>An unprivileged (non-admin) user can exploit an Improper Access Control vulnerability in the Cloudflare WARP Client for Windows (&lt;= 2022.12.582.0) to perform privileged operations with SYSTEM context by working with a combination of opportunistic locks (oplock) and symbolic links (which can both be created by an unprivileged user).</p><div><p>After installing the Cloudflare WARP Client (admin privileges required), an MSI-Installer is placed under C:\\Windows\\Installer. The vulnerability lies in the repair function of this MSI.</p><h3>Impact</h3><p>An unprivileged (non-admin) user can exploit this vulnerability to perform privileged operations with SYSTEM context, including deleting arbitrary files and reading arbitrary file content. This can lead to a variety of attacks, including the manipulation of system files and privilege escalation.</p><h3>Patches</h3><p>A new installer with a fix that addresses this vulnerability was released in version <strong>2023.3.381.0</strong>. While the WARP Client itself is not vulnerable (only the installer), users are encouraged to upgrade to the latest version and delete any older installers present in their systems.</p></div><br>"
						}
					]
				}
			],
			"affected": [
				{
					"vendor": "Cloudflare",
					"product": "WARP",
					"packageName": "WARP Installer",
					"platforms": [
						"Windows"
					],
					"defaultStatus": "unaffected",
					"versions": [
						{
							"status": "affected",
							"versionType": "N/A",
							"version": "0",
							"lessThanOrEqual": "2022.5.309.0",
							"changes": [
								{
									"at": "2023.3.381.0",
									"status": "unaffected"
								}
							]
						}
					]
				}
			],
			"problemTypes": [
				{
					"descriptions": [
						{
							"type": "CWE",
							"lang": "en",
							"description": "CWE-59 Improper Link Resolution Before File Access ('Link Following')",
							"cweId": "CWE-59"
						}
					]
				}
			],
			"impacts": [
				{
					"descriptions": [
						{
							"lang": "en",
							"value": "CAPEC-233 Privilege Escalation"
						}
					],
					"capecId": "CAPEC-233"
				}
			],
			"metrics": [
				{
					"format": "CVSS",
					"scenarios": [
						{
							"lang": "en",
							"value": "GENERAL"
						}
					],
					"cvssV3_1": {
						"version": "3.1",
						"vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
						"attackVector": "LOCAL",
						"attackComplexity": "HIGH",
						"privilegesRequired": "LOW",
						"userInteraction": "NONE",
						"scope": "UNCHANGED",
						"confidentialityImpact": "HIGH",
						"integrityImpact": "HIGH",
						"availabilityImpact": "HIGH",
						"baseScore": 7,
						"baseSeverity": "HIGH"
					}
				}
			],
			"references": [
				{
					"url": "https://github.com/cloudflare/advisories/security/advisories/GHSA-hgxh-48m3-3gq7"
				},
				{
					"url": "https://install.appcenter.ms/orgs/cloudflare/apps/1.1.1.1-windows-1/distribution_groups/release"
				},
				{
					"url": "https://developers.cloudflare.com/warp-client/get-started/windows/"
				}
			],
			"source": {
				"discovery": "EXTERNAL"
			},
			"x_generator": {
				"engine": "Vulnogram 0.1.0-dev"
			}
		}
	}
}
