{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.1",
	"cveMetadata": {
		"cveId": "CVE-2024-23953",
		"assignerOrgId": "f0158376-9dc2-43b6-827c-5f631a4d8d09",
		"assignerShortName": "apache",
		"state": "PUBLISHED",
		"datePublished": "2025-01-28T09:07:22.333Z",
		"dateUpdated": "2025-01-28T14:23:02.324Z",
		"dateReserved": "2024-01-24T15:37:56.409Z"
	},
	"containers": {
		"cna": {
			"providerMetadata": {
				"orgID": "f0158376-9dc2-43b6-827c-5f631a4d8d09",
				"shortName": "apache",
				"dateUpdated": "2025-01-28T09:07:22.333Z"
			},
			"title": "Apache Hive: Timing Attack Against Signature in LLAP util",
			"descriptions": [
				{
					"lang": "en",
					"value": "Use of Arrays.equals() in LlapSignerImpl in Apache Hive to compare message signatures allows attacker to forge a valid signature for an arbitrary message byte by byte. The attacker should be an authorized user of the product to perform this attack. Users are recommended to upgrade to version 4.0.0, which fixes this issue.\n\nThe problem occurs when an application doesn’t use a constant-time algorithm for validating a signature. The method Arrays.equals() returns false right away when it sees that one of the input’s bytes are different. It means that the comparison time depends on the contents of the arrays. This little thing may allow an attacker to forge a valid signature for an arbitrary message byte by byte. So it might allow malicious users to submit splits/work with selected signatures to LLAP without running as a privileged user, potentially leading to DDoS attack.\n\nMore details in the reference section.",
					"supportingMedia": [
						{
							"type": "text/html",
							"base64": false,
							"value": "Use of Arrays.equals() in <span style=\"background-color: rgb(255, 255, 255);\">LlapSignerImpl in&nbsp;</span>Apache Hive to compare message signatures&nbsp;<span style=\"background-color: var(--wht);\">allows attacker to forge a valid signature for an arbitrary message byte by byte. The attacker should be an authorized user of the product to perform this attack.&nbsp;</span>Users are recommended to upgrade to version 4.0.0, which fixes this issue.<br><br><span style=\"background-color: rgb(253, 253, 253);\">The problem occurs when an application doesn’t use a constant-time algorithm for validating a signature.&nbsp;<span style=\"background-color: rgb(253, 253, 253);\">The method </span><code>Arrays.equals()</code><span style=\"background-color: rgb(253, 253, 253);\">&nbsp;returns </span><code>false</code><span style=\"background-color: rgb(253, 253, 253);\">&nbsp;right away when it sees that one of the input’s bytes are different. It means that the comparison time depends on the contents of the arrays. This little thing may allow an attacker to forge a valid signature for an arbitrary message byte by byte.&nbsp;So it might allow malicious users to submit splits/work with selected signatures to LLAP without running as a privileged user, potentially leading to DDoS attack.</span><br><br></span>More details in the reference section.<br>"
						}
					]
				}
			],
			"affected": [
				{
					"vendor": "Apache Software Foundation",
					"product": "Apache Hive",
					"collectionURL": "https://repo.maven.apache.org/maven2",
					"packageName": "org.apache.hive:hive-llap-common",
					"defaultStatus": "unaffected",
					"versions": [
						{
							"status": "affected",
							"versionType": "semver",
							"version": "2.2.0",
							"lessThan": "4.0.0"
						}
					]
				}
			],
			"problemTypes": [
				{
					"descriptions": [
						{
							"type": "CWE",
							"lang": "en",
							"description": "CWE-208: Observable Timing Discrepancy",
							"cweId": "CWE-208"
						}
					]
				}
			],
			"metrics": [
				{
					"other": {
						"type": "Textual description of severity",
						"content": {
							"text": "important"
						}
					}
				}
			],
			"references": [
				{
					"tags": [
						"product"
					],
					"url": "https://github.com/apache/hive"
				},
				{
					"tags": [
						"patch"
					],
					"url": "https://github.com/apache/hive/commit/b418e3c9f479ba8e7d31e6470306111002ffa809"
				},
				{
					"tags": [
						"issue-tracking"
					],
					"url": "https://issues.apache.org/jira/browse/HIVE-28030"
				},
				{
					"tags": [
						"technical-description"
					],
					"url": "https://blog.gypsyengineer.com/en/security/preventing-timing-attacks-with-codeql.html"
				},
				{
					"tags": [
						"technical-description"
					],
					"url": "https://cqr.company/web-vulnerabilities/timing-attacks/"
				},
				{
					"tags": [
						"vendor-advisory"
					],
					"url": "https://lists.apache.org/thread/0nloywj49nbtlc6l3c6363qvq7o1ztb7"
				}
			],
			"credits": [
				{
					"type": "reporter",
					"lang": "en",
					"value": "Andrea Cosentino"
				}
			],
			"source": {
				"defect": [
					"HIVE-28030"
				],
				"discovery": "UNKNOWN"
			},
			"x_generator": {
				"engine": "Vulnogram 0.1.0-dev"
			}
		},
		"adp": [
			{
				"providerMetadata": {
					"orgID": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
					"shortName": "CISA-ADP",
					"dateUpdated": "2025-01-28T14:23:02.324Z"
				},
				"title": "CISA ADP Vulnrichment",
				"problemTypes": [
					{
						"descriptions": [
							{
								"type": "CWE",
								"lang": "en",
								"description": "CWE-290 Authentication Bypass by Spoofing",
								"cweId": "CWE-290"
							}
						]
					}
				],
				"metrics": [
					{
						"cvssV3_1": {
							"version": "3.1",
							"vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N",
							"attackVector": "NETWORK",
							"attackComplexity": "LOW",
							"privilegesRequired": "LOW",
							"userInteraction": "NONE",
							"scope": "UNCHANGED",
							"confidentialityImpact": "NONE",
							"integrityImpact": "HIGH",
							"availabilityImpact": "NONE",
							"baseScore": 6.5,
							"baseSeverity": "MEDIUM"
						}
					},
					{
						"other": {
							"type": "ssvc",
							"content": {
								"id": "CVE-2024-23953",
								"options": [
									{
										"Exploitation": "none"
									},
									{
										"Automatable": "no"
									},
									{
										"Technical Impact": "partial"
									}
								],
								"role": "CISA Coordinator",
								"timestamp": "2025-01-28T14:18:48.359282Z",
								"version": "2.0.3"
							}
						}
					}
				]
			}
		]
	}
}
