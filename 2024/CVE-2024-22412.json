{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.0",
	"cveMetadata": {
		"cveId": "CVE-2024-22412",
		"assignerOrgId": "a0819718-46f1-4df5-94e2-005712e83aaa",
		"assignerShortName": "GitHub_M",
		"state": "PUBLISHED",
		"datePublished": "2024-03-18T20:51:40.313Z",
		"dateUpdated": "2024-03-18T20:51:40.313Z",
		"dateReserved": "2024-01-10T15:09:55.551Z"
	},
	"containers": {
		"cna": {
			"providerMetadata": {
				"orgID": "a0819718-46f1-4df5-94e2-005712e83aaa",
				"shortName": "GitHub_M",
				"dateUpdated": "2024-03-18T20:51:40.313Z"
			},
			"title": "ClickHouse's Role-based Access Control is bypassed when query caching is enabled.",
			"descriptions": [
				{
					"lang": "en",
					"value": "ClickHouse is an open-source column-oriented database management system. A bug exists in the cloud ClickHouse offering prior to version 24.0.2.54535 and in github.com/clickhouse/clickhouse version 23.1. Query caching bypasses the role based access controls and the policies being enforced on roles. In affected versions, the query cache only respects separate users, however this is not documented and not expected behavior. People relying on ClickHouse roles can have their access control lists bypassed if they are using query caching. Attackers who have control of a role could guess queries and see data they shouldn't have access to. Version 24.1 of ClickHouse and version 24.0.2.54535 of ClickHouse Cloud contain a patch for this issue. Based on the documentation, role based access control should be enforced regardless if query caching is enabled or not."
				}
			],
			"affected": [
				{
					"vendor": "ClickHouse",
					"product": "ClickHouse",
					"versions": [
						{
							"status": "affected",
							"version": "= 23.1"
						},
						{
							"status": "affected",
							"version": "< 24.0.2.54535"
						}
					]
				}
			],
			"problemTypes": [
				{
					"descriptions": [
						{
							"type": "CWE",
							"lang": "en",
							"description": "CWE-863: Incorrect Authorization",
							"cweId": "CWE-863"
						}
					]
				}
			],
			"metrics": [
				{
					"cvssV3_1": {
						"version": "3.1",
						"vectorString": "CVSS:3.1/AV:A/AC:L/PR:H/UI:N/S:U/C:L/I:N/A:N",
						"attackVector": "ADJACENT_NETWORK",
						"attackComplexity": "LOW",
						"privilegesRequired": "HIGH",
						"userInteraction": "NONE",
						"scope": "UNCHANGED",
						"confidentialityImpact": "LOW",
						"integrityImpact": "NONE",
						"availabilityImpact": "NONE",
						"baseScore": 2.4,
						"baseSeverity": "LOW"
					}
				}
			],
			"references": [
				{
					"name": "https://github.com/ClickHouse/ClickHouse/security/advisories/GHSA-45h5-f7g3-gr8r",
					"tags": [
						"x_refsource_CONFIRM"
					],
					"url": "https://github.com/ClickHouse/ClickHouse/security/advisories/GHSA-45h5-f7g3-gr8r"
				},
				{
					"name": "https://github.com/ClickHouse/ClickHouse/pull/58611",
					"tags": [
						"x_refsource_MISC"
					],
					"url": "https://github.com/ClickHouse/ClickHouse/pull/58611"
				},
				{
					"name": "https://github.com/ClickHouse/ClickHouse/blob/bd17ee769e337906c4b1f404861e042ad72fcbfc/src/Interpreters/executeQuery.cpp#L1013-L1015",
					"tags": [
						"x_refsource_MISC"
					],
					"url": "https://github.com/ClickHouse/ClickHouse/blob/bd17ee769e337906c4b1f404861e042ad72fcbfc/src/Interpreters/executeQuery.cpp#L1013-L1015"
				}
			],
			"source": {
				"advisory": "GHSA-45h5-f7g3-gr8r",
				"discovery": "UNKNOWN"
			}
		}
	}
}
