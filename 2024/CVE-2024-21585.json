{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.1",
	"cveMetadata": {
		"cveId": "CVE-2024-21585",
		"assignerOrgId": "8cbe9d5a-a066-4c94-8978-4b15efeae968",
		"assignerShortName": "juniper",
		"state": "PUBLISHED",
		"datePublished": "2024-01-12T00:50:59.105Z",
		"dateUpdated": "2024-11-14T14:40:50.210Z",
		"dateReserved": "2023-12-27T19:38:25.702Z"
	},
	"containers": {
		"cna": {
			"providerMetadata": {
				"orgID": "8cbe9d5a-a066-4c94-8978-4b15efeae968",
				"shortName": "juniper",
				"dateUpdated": "2024-01-30T23:32:17.643Z"
			},
			"title": "Junos OS and Junos OS Evolved: BGP session flaps on NSR-enabled devices can cause rpd crash",
			"descriptions": [
				{
					"lang": "en",
					"value": "\nAn Improper Handling of Exceptional Conditions vulnerability in BGP session processing of Juniper Networks Junos OS and Junos OS Evolved allows an unauthenticated network-based attacker, using specific timing outside the attacker's control, to flap BGP sessions and cause the routing protocol daemon (rpd) process to crash and restart, leading to a Denial of Service (DoS) condition. Continued BGP session flapping will create a sustained Denial of Service (DoS) condition.\n\nThis issue only affects routers configured with non-stop routing (NSR) enabled. Graceful Restart (GR) helper mode, enabled by default, is also required for this issue to be exploitable.\n\n\nNote: NSR is not supported on the SRX Series and is therefore not affected by this vulnerability.\nWhen the BGP session flaps on the NSR-enabled router, the device enters GR-helper/LLGR-helper mode due to the peer having negotiated GR/LLGR-restarter capability and the backup BGP requests for replication of the GR/LLGR-helper session, master BGP schedules, and initiates replication of GR/LLGR stale routes to the backup BGP. In this state, if the BGP session with the BGP peer comes up again, unsolicited replication is initiated for the peer without cleaning up the ongoing GR/LLGR-helper mode replication. This parallel two instances of replication for the same peer leads to the assert if the BGP session flaps again.\n\nThis issue affects:\n\nJuniper Networks Junos OS\n\n\n\n  *  All versions earlier than 20.4R3-S9;\n  *  21.2 versions earlier than 21.2R3-S7;\n  *  21.3 versions earlier than 21.3R3-S5;\n  *  21.4 versions earlier than 21.4R3-S5;\n  *  22.1 versions earlier than 22.1R3-S4;\n  *  22.2 versions earlier than 22.2R3-S3;\n  *  22.3 versions earlier than 22.3R3-S1;\n  *  22.4 versions earlier than 22.4R2-S2, 22.4R3;\n  *  23.2 versions earlier than 23.2R1-S1, 23.2R2.\n\n\n\n\nJuniper Networks Junos OS Evolved\n\n\n\n  *  All versions earlier than 21.3R3-S5-EVO;\n  *  21.4 versions earlier than 21.4R3-S5-EVO;\n  *  22.1 versions earlier than 22.1R3-S4-EVO;\n  *  22.2 versions earlier than 22.2R3-S3-EVO;\n  *  22.3 versions earlier than 22.3R3-S1-EVO;\n  *  22.4 versions earlier than 22.4R2-S2-EVO, 22.4R3-EVO;\n  *  23.2 versions earlier than 23.2R1-S1-EVO, 23.2R2-EVO.\n\n\n\n\n\n\n",
					"supportingMedia": [
						{
							"type": "text/html",
							"base64": false,
							"value": "\n\n<p>An Improper Handling of Exceptional Conditions vulnerability in BGP session processing of Juniper Networks Junos OS and Junos OS Evolved allows an unauthenticated network-based attacker, using specific timing outside the attacker's control, to flap BGP sessions and cause the routing protocol daemon (rpd) process to crash and restart, leading to a Denial of Service (DoS) condition. Continued BGP session flapping will create a sustained Denial of Service (DoS) condition.</p><p>This issue only affects routers configured with non-stop routing (NSR) enabled. Graceful Restart (GR) helper mode, enabled by default, is also required for this issue to be exploitable.<br></p>Note: NSR is not supported on the SRX Series and is therefore not affected by this vulnerability.<br><p>When the BGP session flaps on the NSR-enabled router, the device enters GR-helper/LLGR-helper mode due to the peer having negotiated GR/LLGR-restarter capability and the backup BGP requests for replication of the GR/LLGR-helper session, master BGP schedules, and initiates replication of GR/LLGR stale routes to the backup BGP. In this state, if the BGP session with the BGP peer comes up again, unsolicited replication is initiated for the peer without cleaning up the ongoing GR/LLGR-helper mode replication. This parallel two instances of replication for the same peer leads to the assert if the BGP session flaps again.</p><p>This issue affects:</p><p>Juniper Networks Junos OS</p><p></p><ul><li>All versions earlier than 20.4R3-S9;</li><li>21.2 versions earlier than 21.2R3-S7;</li><li>21.3 versions earlier than 21.3R3-S5;</li><li>21.4 versions earlier than 21.4R3-S5;</li><li>22.1 versions earlier than 22.1R3-S4;</li><li>22.2 versions earlier than 22.2R3-S3;</li><li>22.3 versions earlier than 22.3R3-S1;</li><li>22.4 versions earlier than 22.4R2-S2, 22.4R3;</li><li>23.2 versions earlier than 23.2R1-S1, 23.2R2.</li></ul><p></p><p>Juniper Networks Junos OS Evolved</p><p></p><ul><li>All versions earlier than 21.3R3-S5-EVO;</li><li>21.4 versions earlier than 21.4R3-S5-EVO;</li><li>22.1 versions earlier than 22.1R3-S4-EVO;</li><li>22.2 versions earlier than 22.2R3-S3-EVO;</li><li>22.3 versions earlier than 22.3R3-S1-EVO;</li><li>22.4 versions earlier than 22.4R2-S2-EVO, 22.4R3-EVO;</li><li>23.2 versions earlier than 23.2R1-S1-EVO, 23.2R2-EVO.</li></ul><p></p>\n\n"
						}
					]
				}
			],
			"affected": [
				{
					"vendor": "Juniper Networks",
					"product": "Junos OS",
					"platforms": [
						"MX Series",
						"PTX Series",
						"ACX Series",
						"EX Series",
						"QFX Series"
					],
					"defaultStatus": "unaffected",
					"versions": [
						{
							"status": "affected",
							"versionType": "semver",
							"version": "0",
							"lessThan": "20.4R3-S9"
						},
						{
							"status": "affected",
							"versionType": "semver",
							"version": "21.2",
							"lessThan": "21.2R3-S7"
						},
						{
							"status": "affected",
							"versionType": "semver",
							"version": "21.3",
							"lessThan": "21.3R3-S5"
						},
						{
							"status": "affected",
							"versionType": "semver",
							"version": "21.4",
							"lessThan": "21.4R3-S5"
						},
						{
							"status": "affected",
							"versionType": "semver",
							"version": "22.1",
							"lessThan": "22.1R3-S4"
						},
						{
							"status": "affected",
							"versionType": "semver",
							"version": "22.2",
							"lessThan": "22.2R3-S3"
						},
						{
							"status": "affected",
							"versionType": "semver",
							"version": "22.3",
							"lessThan": "22.3R3-S1"
						},
						{
							"status": "affected",
							"versionType": "semver",
							"version": "22.4",
							"lessThan": "22.4R2-S2, 22.4R3"
						},
						{
							"status": "affected",
							"versionType": "semver",
							"version": "23.2",
							"lessThan": "23.2R1-S1, 23.2R2"
						}
					]
				},
				{
					"vendor": "Juniper Networks",
					"product": "Junos OS Evolved",
					"platforms": [
						"PTX Series",
						"ACX Series",
						"QFX Series"
					],
					"defaultStatus": "unaffected",
					"versions": [
						{
							"status": "affected",
							"versionType": "semver",
							"version": "0",
							"lessThan": "21.3R3-S5-EVO"
						},
						{
							"status": "affected",
							"versionType": "semver",
							"version": "21.4",
							"lessThan": "21.4R3-S5-EVO"
						},
						{
							"status": "affected",
							"versionType": "semver",
							"version": "22.1",
							"lessThan": "22.1R3-S4-EVO"
						},
						{
							"status": "affected",
							"versionType": "semver",
							"version": "22.2",
							"lessThan": "22.2R3-S3-EVO"
						},
						{
							"status": "affected",
							"versionType": "semver",
							"version": "22.3",
							"lessThan": "22.3R3-S1-EVO"
						},
						{
							"status": "affected",
							"versionType": "semver",
							"version": "22.4",
							"lessThan": "22.4R2-S2-EVO, 22.4R3-EVO"
						},
						{
							"status": "affected",
							"versionType": "semver",
							"version": "23.2",
							"lessThan": "23.2R1-S1-EVO, 23.2R2-EVO"
						}
					]
				}
			],
			"problemTypes": [
				{
					"descriptions": [
						{
							"type": "CWE",
							"lang": "en",
							"description": "CWE-755 Improper Handling of Exceptional Conditions",
							"cweId": "CWE-755"
						}
					]
				},
				{
					"descriptions": [
						{
							"lang": "en",
							"description": "Denial of Service (DoS)"
						}
					]
				}
			],
			"metrics": [
				{
					"format": "CVSS",
					"scenarios": [
						{
							"lang": "en",
							"value": "GENERAL"
						}
					],
					"cvssV3_1": {
						"version": "3.1",
						"vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
						"attackVector": "NETWORK",
						"attackComplexity": "HIGH",
						"privilegesRequired": "NONE",
						"userInteraction": "NONE",
						"scope": "UNCHANGED",
						"confidentialityImpact": "NONE",
						"integrityImpact": "NONE",
						"availabilityImpact": "HIGH",
						"baseScore": 5.9,
						"baseSeverity": "MEDIUM"
					}
				}
			],
			"workarounds": [
				{
					"lang": "en",
					"value": "Graceful Restart (GR) helper mode and Long-Lived Graceful Restart (LLGR) helper mode can be disabled to prevent this issue.\n\n  [edit protocols bgp graceful-restart]\n  disable;\n\n  [edit protocols bgp graceful-restart long-lived receiver]\n  disable;",
					"supportingMedia": [
						{
							"type": "text/html",
							"base64": false,
							"value": "Graceful Restart (GR) helper mode and Long-Lived Graceful Restart (LLGR) helper mode can be disabled to prevent this issue.<br><br><tt>&nbsp; [edit protocols bgp graceful-restart]<br>&nbsp; disable;<br><br>&nbsp; [edit protocols bgp graceful-restart long-lived receiver]<br>&nbsp; disable;</tt>"
						}
					]
				}
			],
			"solutions": [
				{
					"lang": "en",
					"value": "The following software releases have been updated to resolve this specific issue: \n\nJunos OS: 20.4R3-S9, 21.2R3-S7, 21.3R3-S5, 21.4R3-S5, 22.1R3-S4, 22.2R3-S3, 22.3R3-S1, 22.4R2-S2, 22.4R3, 23.1R2, 23.2R1-S1, 23.2R2, 23.3R1, and all subsequent releases.\n\nJunos OS Evolved: 21.3R3-S5-EVO, 21.4R3-S5-EVO, 22.1R3-S4-EVO, 22.2R3-S3-EVO, 22.3R3-S1-EVO, 22.4R2-S2-EVO, 22.4R3-EVO, 23.1R2-EVO, 23.2R1-S1-EVO, 23.2R2-EVO, 23.3R1-EVO, and all subsequent releases.\n\n",
					"supportingMedia": [
						{
							"type": "text/html",
							"base64": false,
							"value": "<p>The following software releases have been updated to resolve this specific issue: </p><p>Junos OS: 20.4R3-S9, 21.2R3-S7, 21.3R3-S5, 21.4R3-S5, 22.1R3-S4, 22.2R3-S3, 22.3R3-S1, 22.4R2-S2, 22.4R3, 23.1R2, 23.2R1-S1, 23.2R2, 23.3R1, and all subsequent releases.</p><p>Junos OS Evolved: 21.3R3-S5-EVO, 21.4R3-S5-EVO, 22.1R3-S4-EVO, 22.2R3-S3-EVO, 22.3R3-S1-EVO, 22.4R2-S2-EVO, 22.4R3-EVO, 23.1R2-EVO, 23.2R1-S1-EVO, 23.2R2-EVO, 23.3R1-EVO, and all subsequent releases.</p>"
						}
					]
				}
			],
			"exploits": [
				{
					"lang": "en",
					"value": "Juniper SIRT is not aware of any malicious exploitation of this vulnerability.\n\n",
					"supportingMedia": [
						{
							"type": "text/html",
							"base64": false,
							"value": "<p>Juniper SIRT is not aware of any malicious exploitation of this vulnerability.</p>"
						}
					]
				}
			],
			"configurations": [
				{
					"lang": "en",
					"value": "Non-stop routing (NSR) is enabled using the following configuration:\n\n  [edit chassis redundancy]\n  graceful-switchover;\n  \n  [edit routing-options]\n  nonstop-routing;\n",
					"supportingMedia": [
						{
							"type": "text/html",
							"base64": false,
							"value": "Non-stop routing (NSR) is enabled using the following configuration:<br><br><tt>&nbsp; [edit chassis redundancy]<br>&nbsp; graceful-switchover;<br>&nbsp; <br>&nbsp; [edit routing-options]<br>&nbsp; nonstop-routing;</tt><br>"
						}
					]
				}
			],
			"references": [
				{
					"tags": [
						"vendor-advisory"
					],
					"url": "https://supportportal.juniper.net/JSA75723"
				},
				{
					"tags": [
						"technical-description"
					],
					"url": "https://www.first.org/cvss/calculator/4.0#CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:L"
				},
				{
					"tags": [
						"product"
					],
					"url": "https://supportportal.juniper.net/s/article/MX-GR-and-LLGR-capability-and-compatibility-changes-after-15-1-release"
				}
			],
			"timeline": [
				{
					"time": "2024-01-10T17:00:00.000Z",
					"lang": "en",
					"value": "Initial Publication"
				},
				{
					"time": "2024-01-16T17:00:00.000Z",
					"lang": "en",
					"value": "Clarified that SRX Series, which does not support NSR, is not vulnerable"
				},
				{
					"time": "2024-01-30T17:00:00.000Z",
					"lang": "en",
					"value": "Updated required config and workaround to be more precise"
				}
			],
			"source": {
				"advisory": "JSA75723",
				"defect": [
					"1742287"
				],
				"discovery": "USER"
			},
			"datePublic": "2024-01-10T17:00:00.000Z",
			"x_generator": {
				"engine": "Vulnogram 0.1.0-av217"
			}
		},
		"adp": [
			{
				"providerMetadata": {
					"orgID": "af854a3a-2127-422b-91ae-364da2661108",
					"shortName": "CVE",
					"dateUpdated": "2024-08-01T22:27:34.817Z"
				},
				"title": "CVE Program Container",
				"references": [
					{
						"tags": [
							"vendor-advisory",
							"x_transferred"
						],
						"url": "https://supportportal.juniper.net/JSA75723"
					},
					{
						"tags": [
							"technical-description",
							"x_transferred"
						],
						"url": "https://www.first.org/cvss/calculator/4.0#CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:N/VI:N/VA:H/SC:N/SI:N/SA:L"
					},
					{
						"tags": [
							"product",
							"x_transferred"
						],
						"url": "https://supportportal.juniper.net/s/article/MX-GR-and-LLGR-capability-and-compatibility-changes-after-15-1-release"
					}
				]
			},
			{
				"providerMetadata": {
					"orgID": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
					"shortName": "CISA-ADP",
					"dateUpdated": "2024-11-14T14:40:50.210Z"
				},
				"title": "CISA ADP Vulnrichment",
				"metrics": [
					{
						"other": {
							"type": "ssvc",
							"content": {
								"id": "CVE-2024-21585",
								"options": [
									{
										"Exploitation": "none"
									},
									{
										"Automatable": "no"
									},
									{
										"Technical Impact": "partial"
									}
								],
								"role": "CISA Coordinator",
								"timestamp": "2024-11-14T14:40:34.207129Z",
								"version": "2.0.3"
							}
						}
					}
				]
			}
		]
	}
}
