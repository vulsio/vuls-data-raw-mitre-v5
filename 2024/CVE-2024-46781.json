{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.1",
	"cveMetadata": {
		"cveId": "CVE-2024-46781",
		"assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
		"assignerShortName": "Linux",
		"state": "PUBLISHED",
		"datePublished": "2024-09-18T07:12:37.603Z",
		"dateUpdated": "2024-09-18T07:12:37.603Z",
		"dateReserved": "2024-09-11T15:12:18.276Z"
	},
	"containers": {
		"cna": {
			"providerMetadata": {
				"orgID": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
				"shortName": "Linux",
				"dateUpdated": "2024-09-18T07:12:37.603Z"
			},
			"title": "nilfs2: fix missing cleanup on rollforward recovery error",
			"descriptions": [
				{
					"lang": "en",
					"value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnilfs2: fix missing cleanup on rollforward recovery error\n\nIn an error injection test of a routine for mount-time recovery, KASAN\nfound a use-after-free bug.\n\nIt turned out that if data recovery was performed using partial logs\ncreated by dsync writes, but an error occurred before starting the log\nwriter to create a recovered checkpoint, the inodes whose data had been\nrecovered were left in the ns_dirty_files list of the nilfs object and\nwere not freed.\n\nFix this issue by cleaning up inodes that have read the recovery data if\nthe recovery routine fails midway before the log writer starts."
				}
			],
			"affected": [
				{
					"vendor": "Linux",
					"product": "Linux",
					"programFiles": [
						"fs/nilfs2/recovery.c"
					],
					"repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
					"defaultStatus": "unaffected",
					"versions": [
						{
							"status": "affected",
							"versionType": "git",
							"version": "0f3e1c7f23f8",
							"lessThan": "35a9a7a7d946"
						},
						{
							"status": "affected",
							"versionType": "git",
							"version": "0f3e1c7f23f8",
							"lessThan": "da02f9eb3333"
						},
						{
							"status": "affected",
							"versionType": "git",
							"version": "0f3e1c7f23f8",
							"lessThan": "07e4dc2fe000"
						},
						{
							"status": "affected",
							"versionType": "git",
							"version": "0f3e1c7f23f8",
							"lessThan": "8e2d1e9d93c4"
						},
						{
							"status": "affected",
							"versionType": "git",
							"version": "0f3e1c7f23f8",
							"lessThan": "ca92c4bff283"
						},
						{
							"status": "affected",
							"versionType": "git",
							"version": "0f3e1c7f23f8",
							"lessThan": "9d8c3a585d56"
						},
						{
							"status": "affected",
							"versionType": "git",
							"version": "0f3e1c7f23f8",
							"lessThan": "1cf1f7e8cd47"
						},
						{
							"status": "affected",
							"versionType": "git",
							"version": "0f3e1c7f23f8",
							"lessThan": "5787fcaab9eb"
						}
					]
				},
				{
					"vendor": "Linux",
					"product": "Linux",
					"programFiles": [
						"fs/nilfs2/recovery.c"
					],
					"repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
					"defaultStatus": "affected",
					"versions": [
						{
							"status": "affected",
							"version": "2.6.30"
						},
						{
							"status": "unaffected",
							"versionType": "custom",
							"version": "0",
							"lessThan": "2.6.30"
						},
						{
							"status": "unaffected",
							"versionType": "custom",
							"version": "4.19.322",
							"lessThanOrEqual": "4.19.*"
						},
						{
							"status": "unaffected",
							"versionType": "custom",
							"version": "5.4.284",
							"lessThanOrEqual": "5.4.*"
						},
						{
							"status": "unaffected",
							"versionType": "custom",
							"version": "5.10.226",
							"lessThanOrEqual": "5.10.*"
						},
						{
							"status": "unaffected",
							"versionType": "custom",
							"version": "5.15.167",
							"lessThanOrEqual": "5.15.*"
						},
						{
							"status": "unaffected",
							"versionType": "custom",
							"version": "6.1.110",
							"lessThanOrEqual": "6.1.*"
						},
						{
							"status": "unaffected",
							"versionType": "custom",
							"version": "6.6.51",
							"lessThanOrEqual": "6.6.*"
						},
						{
							"status": "unaffected",
							"versionType": "custom",
							"version": "6.10.10",
							"lessThanOrEqual": "6.10.*"
						},
						{
							"status": "unaffected",
							"versionType": "original_commit_for_fix",
							"version": "6.11",
							"lessThanOrEqual": "*"
						}
					]
				}
			],
			"references": [
				{
					"url": "https://git.kernel.org/stable/c/35a9a7a7d94662146396199b0cfd95f9517cdd14"
				},
				{
					"url": "https://git.kernel.org/stable/c/da02f9eb333333b2e4f25d2a14967cff785ac82e"
				},
				{
					"url": "https://git.kernel.org/stable/c/07e4dc2fe000ab008bcfe90be4324ef56b5b4355"
				},
				{
					"url": "https://git.kernel.org/stable/c/8e2d1e9d93c4ec51354229361ac3373058529ec4"
				},
				{
					"url": "https://git.kernel.org/stable/c/ca92c4bff2833cb30d493b935168d6cccd5c805d"
				},
				{
					"url": "https://git.kernel.org/stable/c/9d8c3a585d564d776ee60d4aabec59b404be7403"
				},
				{
					"url": "https://git.kernel.org/stable/c/1cf1f7e8cd47244fa947d357ef1f642d91e219a3"
				},
				{
					"url": "https://git.kernel.org/stable/c/5787fcaab9eb5930f5378d6a1dd03d916d146622"
				}
			],
			"x_generator": {
				"engine": "bippy-c9c4e1df01b2"
			}
		}
	}
}
