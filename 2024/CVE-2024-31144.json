{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.1",
	"cveMetadata": {
		"cveId": "CVE-2024-31144",
		"assignerOrgId": "23aa2041-22e1-471f-9209-9b7396fa234f",
		"assignerShortName": "XEN",
		"state": "PUBLISHED",
		"datePublished": "2025-02-14T20:16:39.941Z",
		"dateUpdated": "2025-02-14T21:02:33.238Z",
		"dateReserved": "2024-03-28T18:14:12.892Z"
	},
	"containers": {
		"cna": {
			"providerMetadata": {
				"orgID": "23aa2041-22e1-471f-9209-9b7396fa234f",
				"shortName": "XEN",
				"dateUpdated": "2025-02-14T20:16:39.941Z"
			},
			"title": "Xapi: Metadata injection attack against backup/restore functionality",
			"descriptions": [
				{
					"lang": "en",
					"value": "For a brief summary of Xapi terminology, see:\n\n   https://xapi-project.github.io/xen-api/overview.html#object-model-overview \n\nXapi contains functionality to backup and restore metadata about Virtual\nMachines and Storage Repositories (SRs).\n\nThe metadata itself is stored in a Virtual Disk Image (VDI) inside an\nSR.  This is used for two purposes; a general backup of metadata\n(e.g. to recover from a host failure if the filer is still good), and\nPortable SRs (e.g. using an external hard drive to move VMs to another\nhost).\n\nMetadata is only restored as an explicit administrator action, but\noccurs in cases where the host has no information about the SR, and must\nlocate the metadata VDI in order to retrieve the metadata.\n\nThe metadata VDI is located by searching (in UUID alphanumeric order)\neach VDI, mounting it, and seeing if there is a suitable metadata file\npresent.  The first matching VDI is deemed to be the metadata VDI, and\nis restored from.\n\nIn the general case, the content of VDIs are controlled by the VM owner,\nand should not be trusted by the host administrator.\n\nA malicious guest can manipulate its disk to appear to be a metadata\nbackup.\n\nA guest cannot choose the UUIDs of its VDIs, but a guest with one disk\nhas a 50% chance of sorting ahead of the legitimate metadata backup.  A\nguest with two disks has a 75% chance, etc.",
					"supportingMedia": [
						{
							"type": "text/html",
							"base64": false,
							"value": "<pre>For a brief summary of Xapi terminology, see:\n\n  <a target=\"_blank\" rel=\"nofollow\" href=\"https://xapi-project.github.io/xen-api/overview.html#object-model-overview\">https://xapi-project.github.io/xen-api/overview.html#object-model-overview</a>\n\nXapi contains functionality to backup and restore metadata about Virtual\nMachines and Storage Repositories (SRs).\n\nThe metadata itself is stored in a Virtual Disk Image (VDI) inside an\nSR.  This is used for two purposes; a general backup of metadata\n(e.g. to recover from a host failure if the filer is still good), and\nPortable SRs (e.g. using an external hard drive to move VMs to another\nhost).\n\nMetadata is only restored as an explicit administrator action, but\noccurs in cases where the host has no information about the SR, and must\nlocate the metadata VDI in order to retrieve the metadata.\n\nThe metadata VDI is located by searching (in UUID alphanumeric order)\neach VDI, mounting it, and seeing if there is a suitable metadata file\npresent.  The first matching VDI is deemed to be the metadata VDI, and\nis restored from.\n\nIn the general case, the content of VDIs are controlled by the VM owner,\nand should not be trusted by the host administrator.\n\nA malicious guest can manipulate its disk to appear to be a metadata\nbackup.\n\nA guest cannot choose the UUIDs of its VDIs, but a guest with one disk\nhas a 50% chance of sorting ahead of the legitimate metadata backup.  A\nguest with two disks has a 75% chance, etc.</pre><br>"
						}
					]
				}
			],
			"affected": [
				{
					"vendor": "Xen Project",
					"product": "Xen",
					"defaultStatus": "unknown",
					"versions": [
						{
							"status": "unknown",
							"version": "consult Xen advisory XSA-459"
						}
					]
				}
			],
			"impacts": [
				{
					"descriptions": [
						{
							"lang": "en",
							"value": "If a fraudulent metadata backup has been written into an SR which also contains a legitimate metadata backup, and an administrator explicitly chooses to restore from backup, the fraudulent metadata might be consumed instead of the legitimate metadata.  Control over meta data includes: which VMs are created, disk assignment, vCPU/RAM requirements, GPU allocation, etc."
						}
					]
				}
			],
			"workarounds": [
				{
					"lang": "en",
					"value": "Not using the metadata restore functionality avoids the vulnerability.",
					"supportingMedia": [
						{
							"type": "text/html",
							"base64": false,
							"value": "<pre>Not using the metadata restore functionality avoids the vulnerability.</pre><br>"
						}
					]
				}
			],
			"configurations": [
				{
					"lang": "en",
					"value": "Systems running Xapi v1.249.x are affected.\n\nSystems running Xapi v24.x are potentially affected.  However it is\nbelieved that the only supported products using this version of Xapi\nhave not shipped the metadata backup/restore functionality.\n\nTo leverage the vulnerability, an attacker would likely need insider\ninformation to construct a plausible-looking metadata backup, and would\nhave to persuade a real administrator to perform a data-recovery action.",
					"supportingMedia": [
						{
							"type": "text/html",
							"base64": false,
							"value": "<pre>Systems running Xapi v1.249.x are affected.\n\nSystems running Xapi v24.x are potentially affected.  However it is\nbelieved that the only supported products using this version of Xapi\nhave not shipped the metadata backup/restore functionality.\n\nTo leverage the vulnerability, an attacker would likely need insider\ninformation to construct a plausible-looking metadata backup, and would\nhave to persuade a real administrator to perform a data-recovery action.\n</pre><br>"
						}
					]
				}
			],
			"references": [
				{
					"url": "https://xenbits.xen.org/xsa/advisory-459.html"
				}
			],
			"credits": [
				{
					"type": "finder",
					"lang": "en",
					"value": "This issue was discovered by XenServer."
				}
			],
			"source": {
				"discovery": "UNKNOWN"
			},
			"datePublic": "2024-07-16T11:00:00.000Z",
			"x_generator": {
				"engine": "Vulnogram 0.2.0"
			}
		},
		"adp": [
			{
				"providerMetadata": {
					"orgID": "af854a3a-2127-422b-91ae-364da2661108",
					"shortName": "CVE",
					"dateUpdated": "2025-02-14T21:02:33.238Z"
				},
				"title": "CVE Program Container",
				"references": [
					{
						"url": "http://www.openwall.com/lists/oss-security/2024/07/16/4"
					}
				]
			}
		]
	}
}
