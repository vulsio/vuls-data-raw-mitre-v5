{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.1",
	"cveMetadata": {
		"cveId": "CVE-2024-52307",
		"assignerOrgId": "a0819718-46f1-4df5-94e2-005712e83aaa",
		"assignerShortName": "GitHub_M",
		"state": "PUBLISHED",
		"datePublished": "2024-11-21T17:14:51.677Z",
		"dateUpdated": "2024-11-21T17:14:51.677Z",
		"dateReserved": "2024-11-06T19:00:26.397Z"
	},
	"containers": {
		"cna": {
			"providerMetadata": {
				"orgID": "a0819718-46f1-4df5-94e2-005712e83aaa",
				"shortName": "GitHub_M",
				"dateUpdated": "2024-11-21T17:14:51.677Z"
			},
			"title": "authentik allows a timing attack due to missing constant time comparison for metrics view",
			"descriptions": [
				{
					"lang": "en",
					"value": "authentik is an open-source identity provider. Due to the usage of a non-constant time comparison for the /-/metrics/ endpoint it was possible to brute-force the SECRET_KEY, which is used to authenticate the endpoint. The /-/metrics/ endpoint returns Prometheus metrics and is not intended to be accessed directly, as the Go proxy running in the authentik server container fetches data from this endpoint and serves it on a separate port (9300 by default), which can be scraped by Prometheus without being exposed publicly. authentik 2024.8.5 and 2024.10.3 fix this issue. Since the /-/metrics/ endpoint is not intended to be accessed publicly, requests to the endpoint can be blocked by the reverse proxy/load balancer used in conjunction with authentik."
				}
			],
			"affected": [
				{
					"vendor": "goauthentik",
					"product": "authentik",
					"versions": [
						{
							"status": "affected",
							"version": "< 2024.8.5"
						},
						{
							"status": "affected",
							"version": ">= 2024.10.0-rc1, < 2024.10.3"
						}
					]
				}
			],
			"problemTypes": [
				{
					"descriptions": [
						{
							"type": "CWE",
							"lang": "en",
							"description": "CWE-208: Observable Timing Discrepancy",
							"cweId": "CWE-208"
						}
					]
				}
			],
			"metrics": [
				{
					"cvssV4_0": {
						"version": "4.0",
						"vectorString": "CVSS:4.0/AV:N/AC:L/AT:P/PR:N/UI:N/VC:L/VI:L/VA:L/SC:L/SI:N/SA:N",
						"baseScore": 6.3,
						"baseSeverity": "MEDIUM",
						"attackVector": "NETWORK",
						"attackComplexity": "LOW",
						"attackRequirements": "PRESENT",
						"privilegesRequired": "NONE",
						"userInteraction": "NONE",
						"vulnConfidentialityImpact": "LOW",
						"vulnIntegrityImpact": "LOW",
						"vulnAvailabilityImpact": "LOW",
						"subConfidentialityImpact": "LOW",
						"subIntegrityImpact": "NONE",
						"subAvailabilityImpact": "NONE"
					}
				}
			],
			"references": [
				{
					"name": "https://github.com/goauthentik/authentik/security/advisories/GHSA-2xrw-5f2x-m56j",
					"tags": [
						"x_refsource_CONFIRM"
					],
					"url": "https://github.com/goauthentik/authentik/security/advisories/GHSA-2xrw-5f2x-m56j"
				},
				{
					"name": "https://github.com/goauthentik/authentik/commit/5ea4580884f99369f0ccfe484c04cb03a66e65b8",
					"tags": [
						"x_refsource_MISC"
					],
					"url": "https://github.com/goauthentik/authentik/commit/5ea4580884f99369f0ccfe484c04cb03a66e65b8"
				}
			],
			"source": {
				"advisory": "GHSA-2xrw-5f2x-m56j",
				"discovery": "UNKNOWN"
			}
		}
	}
}
