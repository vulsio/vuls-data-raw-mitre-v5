{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.1",
	"cveMetadata": {
		"assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
		"assignerShortName": "Linux",
		"cveId": "CVE-2024-35900",
		"datePublished": "2024-05-19T08:34:54.016Z",
		"dateReserved": "2024-05-17T13:50:33.114Z",
		"dateUpdated": "2024-05-19T08:34:54.016Z",
		"state": "PUBLISHED"
	},
	"containers": {
		"cna": {
			"affected": [
				{
					"defaultStatus": "unaffected",
					"product": "Linux",
					"repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
					"vendor": "Linux",
					"versions": [
						{
							"lessThan": "41bad13c0e8a",
							"status": "affected",
							"version": "e10f661adc55",
							"versionType": "git"
						},
						{
							"lessThan": "7b6fba691871",
							"status": "affected",
							"version": "d9c4da8cb74e",
							"versionType": "git"
						},
						{
							"lessThan": "8ba81dca416a",
							"status": "affected",
							"version": "179d9ba5559a",
							"versionType": "git"
						},
						{
							"lessThan": "745cf6a84389",
							"status": "affected",
							"version": "179d9ba5559a",
							"versionType": "git"
						},
						{
							"lessThan": "420132bee3d0",
							"status": "affected",
							"version": "179d9ba5559a",
							"versionType": "git"
						},
						{
							"lessThan": "e95bb4cba94c",
							"status": "affected",
							"version": "179d9ba5559a",
							"versionType": "git"
						},
						{
							"lessThan": "994209ddf4f4",
							"status": "affected",
							"version": "179d9ba5559a",
							"versionType": "git"
						}
					]
				},
				{
					"defaultStatus": "affected",
					"product": "Linux",
					"repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
					"vendor": "Linux",
					"versions": [
						{
							"status": "affected",
							"version": "5.13"
						},
						{
							"lessThan": "5.13",
							"status": "unaffected",
							"version": "0",
							"versionType": "custom"
						},
						{
							"lessThanOrEqual": "5.4.*",
							"status": "unaffected",
							"version": "5.4.274",
							"versionType": "custom"
						},
						{
							"lessThanOrEqual": "5.10.*",
							"status": "unaffected",
							"version": "5.10.215",
							"versionType": "custom"
						},
						{
							"lessThanOrEqual": "5.15.*",
							"status": "unaffected",
							"version": "5.15.154",
							"versionType": "custom"
						},
						{
							"lessThanOrEqual": "6.1.*",
							"status": "unaffected",
							"version": "6.1.85",
							"versionType": "custom"
						},
						{
							"lessThanOrEqual": "6.6.*",
							"status": "unaffected",
							"version": "6.6.26",
							"versionType": "custom"
						},
						{
							"lessThanOrEqual": "6.8.*",
							"status": "unaffected",
							"version": "6.8.5",
							"versionType": "custom"
						},
						{
							"lessThanOrEqual": "*",
							"status": "unaffected",
							"version": "6.9",
							"versionType": "original_commit_for_fix"
						}
					]
				}
			],
			"descriptions": [
				{
					"lang": "en",
					"value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnetfilter: nf_tables: reject new basechain after table flag update\n\nWhen dormant flag is toggled, hooks are disabled in the commit phase by\niterating over current chains in table (existing and new).\n\nThe following configuration allows for an inconsistent state:\n\n  add table x\n  add chain x y { type filter hook input priority 0; }\n  add table x { flags dormant; }\n  add chain x w { type filter hook input priority 1; }\n\nwhich triggers the following warning when trying to unregister chain w\nwhich is already unregistered.\n\n[  127.322252] WARNING: CPU: 7 PID: 1211 at net/netfilter/core.c:50                                                                     1 __nf_unregister_net_hook+0x21a/0x260\n[...]\n[  127.322519] Call Trace:\n[  127.322521]  <TASK>\n[  127.322524]  ? __warn+0x9f/0x1a0\n[  127.322531]  ? __nf_unregister_net_hook+0x21a/0x260\n[  127.322537]  ? report_bug+0x1b1/0x1e0\n[  127.322545]  ? handle_bug+0x3c/0x70\n[  127.322552]  ? exc_invalid_op+0x17/0x40\n[  127.322556]  ? asm_exc_invalid_op+0x1a/0x20\n[  127.322563]  ? kasan_save_free_info+0x3b/0x60\n[  127.322570]  ? __nf_unregister_net_hook+0x6a/0x260\n[  127.322577]  ? __nf_unregister_net_hook+0x21a/0x260\n[  127.322583]  ? __nf_unregister_net_hook+0x6a/0x260\n[  127.322590]  ? __nf_tables_unregister_hook+0x8a/0xe0 [nf_tables]\n[  127.322655]  nft_table_disable+0x75/0xf0 [nf_tables]\n[  127.322717]  nf_tables_commit+0x2571/0x2620 [nf_tables]"
				}
			],
			"providerMetadata": {
				"dateUpdated": "2024-05-19T08:34:54.016Z",
				"orgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
				"shortName": "Linux"
			},
			"references": [
				{
					"url": "https://git.kernel.org/stable/c/41bad13c0e8a5a2b47a7472cced922555372daab"
				},
				{
					"url": "https://git.kernel.org/stable/c/7b6fba6918714afee3e17796113ccab636255c7b"
				},
				{
					"url": "https://git.kernel.org/stable/c/8ba81dca416adf82fc5a2a23abc1a8cc02ad32fb"
				},
				{
					"url": "https://git.kernel.org/stable/c/745cf6a843896cdac8766c74379300ed73c78830"
				},
				{
					"url": "https://git.kernel.org/stable/c/420132bee3d0136b7fba253a597b098fe15493a7"
				},
				{
					"url": "https://git.kernel.org/stable/c/e95bb4cba94c018be24b11f017d1c55dd6cda31a"
				},
				{
					"url": "https://git.kernel.org/stable/c/994209ddf4f430946f6247616b2e33d179243769"
				}
			],
			"title": "netfilter: nf_tables: reject new basechain after table flag update",
			"x_generator": {
				"engine": "bippy-d175d3acf727"
			}
		}
	}
}
