{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.1",
	"cveMetadata": {
		"cveId": "CVE-2024-57947",
		"assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
		"assignerShortName": "Linux",
		"state": "PUBLISHED",
		"datePublished": "2025-01-23T13:54:20.267Z",
		"dateUpdated": "2025-01-23T13:54:20.267Z",
		"dateReserved": "2025-01-19T11:50:08.380Z"
	},
	"containers": {
		"cna": {
			"providerMetadata": {
				"orgID": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
				"shortName": "Linux",
				"dateUpdated": "2025-01-23T13:54:20.267Z"
			},
			"title": "netfilter: nf_set_pipapo: fix initial map fill",
			"descriptions": [
				{
					"lang": "en",
					"value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnetfilter: nf_set_pipapo: fix initial map fill\n\nThe initial buffer has to be inited to all-ones, but it must restrict\nit to the size of the first field, not the total field size.\n\nAfter each round in the map search step, the result and the fill map\nare swapped, so if we have a set where f->bsize of the first element\nis smaller than m->bsize_max, those one-bits are leaked into future\nrounds result map.\n\nThis makes pipapo find an incorrect matching results for sets where\nfirst field size is not the largest.\n\nFollowup patch adds a test case to nft_concat_range.sh selftest script.\n\nThanks to Stefano Brivio for pointing out that we need to zero out\nthe remainder explicitly, only correcting memset() argument isn't enough."
				}
			],
			"affected": [
				{
					"vendor": "Linux",
					"product": "Linux",
					"programFiles": [
						"net/netfilter/nft_set_pipapo.c",
						"net/netfilter/nft_set_pipapo.h",
						"net/netfilter/nft_set_pipapo_avx2.c"
					],
					"repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
					"defaultStatus": "unaffected",
					"versions": [
						{
							"status": "affected",
							"versionType": "git",
							"version": "3c4287f62044a90e73a561aa05fc46e62da173da",
							"lessThan": "957a4d1c4c5849e4515c9fb4db21bf85318103dc"
						},
						{
							"status": "affected",
							"versionType": "git",
							"version": "3c4287f62044a90e73a561aa05fc46e62da173da",
							"lessThan": "9625c46ce6fd4f922595a4b32b1de5066d70464f"
						},
						{
							"status": "affected",
							"versionType": "git",
							"version": "3c4287f62044a90e73a561aa05fc46e62da173da",
							"lessThan": "69b6a67f7052905e928d75a0c5871de50e686986"
						},
						{
							"status": "affected",
							"versionType": "git",
							"version": "3c4287f62044a90e73a561aa05fc46e62da173da",
							"lessThan": "8058c88ac0df21239daee54b5934d5c80ca9685f"
						},
						{
							"status": "affected",
							"versionType": "git",
							"version": "3c4287f62044a90e73a561aa05fc46e62da173da",
							"lessThan": "791a615b7ad2258c560f91852be54b0480837c93"
						}
					]
				},
				{
					"vendor": "Linux",
					"product": "Linux",
					"programFiles": [
						"net/netfilter/nft_set_pipapo.c",
						"net/netfilter/nft_set_pipapo.h",
						"net/netfilter/nft_set_pipapo_avx2.c"
					],
					"repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
					"defaultStatus": "affected",
					"versions": [
						{
							"status": "affected",
							"version": "5.6"
						},
						{
							"status": "unaffected",
							"versionType": "semver",
							"version": "0",
							"lessThan": "5.6"
						},
						{
							"status": "unaffected",
							"versionType": "semver",
							"version": "5.15.165",
							"lessThanOrEqual": "5.15.*"
						},
						{
							"status": "unaffected",
							"versionType": "semver",
							"version": "6.1.103",
							"lessThanOrEqual": "6.1.*"
						},
						{
							"status": "unaffected",
							"versionType": "semver",
							"version": "6.6.44",
							"lessThanOrEqual": "6.6.*"
						},
						{
							"status": "unaffected",
							"versionType": "semver",
							"version": "6.10.3",
							"lessThanOrEqual": "6.10.*"
						},
						{
							"status": "unaffected",
							"versionType": "original_commit_for_fix",
							"version": "6.11",
							"lessThanOrEqual": "*"
						}
					]
				}
			],
			"references": [
				{
					"url": "https://git.kernel.org/stable/c/957a4d1c4c5849e4515c9fb4db21bf85318103dc"
				},
				{
					"url": "https://git.kernel.org/stable/c/9625c46ce6fd4f922595a4b32b1de5066d70464f"
				},
				{
					"url": "https://git.kernel.org/stable/c/69b6a67f7052905e928d75a0c5871de50e686986"
				},
				{
					"url": "https://git.kernel.org/stable/c/8058c88ac0df21239daee54b5934d5c80ca9685f"
				},
				{
					"url": "https://git.kernel.org/stable/c/791a615b7ad2258c560f91852be54b0480837c93"
				}
			],
			"x_generator": {
				"engine": "bippy-5f407fcff5a0"
			}
		}
	}
}
