{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.1",
	"cveMetadata": {
		"cveId": "CVE-2024-47703",
		"assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
		"assignerShortName": "Linux",
		"state": "PUBLISHED",
		"datePublished": "2024-10-21T11:53:38.714Z",
		"dateUpdated": "2024-10-21T11:53:38.714Z",
		"dateReserved": "2024-09-30T16:00:12.945Z"
	},
	"containers": {
		"cna": {
			"providerMetadata": {
				"orgID": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
				"shortName": "Linux",
				"dateUpdated": "2024-10-21T11:53:38.714Z"
			},
			"title": "bpf, lsm: Add check for BPF LSM return value",
			"descriptions": [
				{
					"lang": "en",
					"value": "In the Linux kernel, the following vulnerability has been resolved:\n\nbpf, lsm: Add check for BPF LSM return value\n\nA bpf prog returning a positive number attached to file_alloc_security\nhook makes kernel panic.\n\nThis happens because file system can not filter out the positive number\nreturned by the LSM prog using IS_ERR, and misinterprets this positive\nnumber as a file pointer.\n\nGiven that hook file_alloc_security never returned positive number\nbefore the introduction of BPF LSM, and other BPF LSM hooks may\nencounter similar issues, this patch adds LSM return value check\nin verifier, to ensure no unexpected value is returned."
				}
			],
			"affected": [
				{
					"vendor": "Linux",
					"product": "Linux",
					"programFiles": [
						"include/linux/bpf.h",
						"include/linux/bpf_lsm.h",
						"kernel/bpf/bpf_lsm.c",
						"kernel/bpf/btf.c",
						"kernel/bpf/verifier.c"
					],
					"repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
					"defaultStatus": "unaffected",
					"versions": [
						{
							"status": "affected",
							"versionType": "git",
							"version": "520b7aa00d8c",
							"lessThan": "1050727d83e7"
						},
						{
							"status": "affected",
							"versionType": "git",
							"version": "520b7aa00d8c",
							"lessThan": "27ca3e20fe80"
						},
						{
							"status": "affected",
							"versionType": "git",
							"version": "520b7aa00d8c",
							"lessThan": "5d99e198be27"
						}
					]
				},
				{
					"vendor": "Linux",
					"product": "Linux",
					"programFiles": [
						"include/linux/bpf.h",
						"include/linux/bpf_lsm.h",
						"kernel/bpf/bpf_lsm.c",
						"kernel/bpf/btf.c",
						"kernel/bpf/verifier.c"
					],
					"repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
					"defaultStatus": "affected",
					"versions": [
						{
							"status": "affected",
							"version": "5.7"
						},
						{
							"status": "unaffected",
							"versionType": "custom",
							"version": "0",
							"lessThan": "5.7"
						},
						{
							"status": "unaffected",
							"versionType": "custom",
							"version": "6.10.13",
							"lessThanOrEqual": "6.10.*"
						},
						{
							"status": "unaffected",
							"versionType": "custom",
							"version": "6.11.2",
							"lessThanOrEqual": "6.11.*"
						},
						{
							"status": "unaffected",
							"versionType": "original_commit_for_fix",
							"version": "6.12-rc1",
							"lessThanOrEqual": "*"
						}
					]
				}
			],
			"references": [
				{
					"url": "https://git.kernel.org/stable/c/1050727d83e70449991c29dd1cf29fe936a63da3"
				},
				{
					"url": "https://git.kernel.org/stable/c/27ca3e20fe80be85a92b10064dfeb56cb2564b1c"
				},
				{
					"url": "https://git.kernel.org/stable/c/5d99e198be279045e6ecefe220f5c52f8ce9bfd5"
				}
			],
			"x_generator": {
				"engine": "bippy-c9c4e1df01b2"
			}
		}
	}
}
