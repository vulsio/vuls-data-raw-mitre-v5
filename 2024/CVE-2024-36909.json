{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.1",
	"cveMetadata": {
		"assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
		"assignerShortName": "Linux",
		"cveId": "CVE-2024-36909",
		"datePublished": "2024-05-30T15:29:08.339Z",
		"dateReserved": "2024-05-30T15:25:07.067Z",
		"dateUpdated": "2024-05-30T15:29:08.339Z",
		"state": "PUBLISHED"
	},
	"containers": {
		"cna": {
			"affected": [
				{
					"defaultStatus": "unaffected",
					"product": "Linux",
					"programFiles": [
						"drivers/hv/channel.c"
					],
					"repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
					"vendor": "Linux",
					"versions": [
						{
							"lessThan": "2f622008bf78",
							"status": "affected",
							"version": "1da177e4c3f4",
							"versionType": "git"
						},
						{
							"lessThan": "82f9e213b124",
							"status": "affected",
							"version": "1da177e4c3f4",
							"versionType": "git"
						},
						{
							"lessThan": "a9212a4e2963",
							"status": "affected",
							"version": "1da177e4c3f4",
							"versionType": "git"
						},
						{
							"lessThan": "30d18df6567b",
							"status": "affected",
							"version": "1da177e4c3f4",
							"versionType": "git"
						}
					]
				},
				{
					"defaultStatus": "affected",
					"product": "Linux",
					"programFiles": [
						"drivers/hv/channel.c"
					],
					"repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
					"vendor": "Linux",
					"versions": [
						{
							"lessThanOrEqual": "6.1.*",
							"status": "unaffected",
							"version": "6.1.91",
							"versionType": "custom"
						},
						{
							"lessThanOrEqual": "6.6.*",
							"status": "unaffected",
							"version": "6.6.31",
							"versionType": "custom"
						},
						{
							"lessThanOrEqual": "6.8.*",
							"status": "unaffected",
							"version": "6.8.10",
							"versionType": "custom"
						},
						{
							"lessThanOrEqual": "*",
							"status": "unaffected",
							"version": "6.9",
							"versionType": "original_commit_for_fix"
						}
					]
				}
			],
			"descriptions": [
				{
					"lang": "en",
					"value": "In the Linux kernel, the following vulnerability has been resolved:\n\nDrivers: hv: vmbus: Don't free ring buffers that couldn't be re-encrypted\n\nIn CoCo VMs it is possible for the untrusted host to cause\nset_memory_encrypted() or set_memory_decrypted() to fail such that an\nerror is returned and the resulting memory is shared. Callers need to\ntake care to handle these errors to avoid returning decrypted (shared)\nmemory to the page allocator, which could lead to functional or security\nissues.\n\nThe VMBus ring buffer code could free decrypted/shared pages if\nset_memory_decrypted() fails. Check the decrypted field in the struct\nvmbus_gpadl for the ring buffers to decide whether to free the memory."
				}
			],
			"providerMetadata": {
				"dateUpdated": "2024-05-30T15:29:08.339Z",
				"orgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
				"shortName": "Linux"
			},
			"references": [
				{
					"url": "https://git.kernel.org/stable/c/2f622008bf784a9f5dd17baa19223cc2ac30a039"
				},
				{
					"url": "https://git.kernel.org/stable/c/82f9e213b124a7d2bb5b16ea35d570260ef467e0"
				},
				{
					"url": "https://git.kernel.org/stable/c/a9212a4e2963a7fbe3864ba33dc551d4ad8d0abb"
				},
				{
					"url": "https://git.kernel.org/stable/c/30d18df6567be09c1433e81993e35e3da573ac48"
				}
			],
			"title": "Drivers: hv: vmbus: Don't free ring buffers that couldn't be re-encrypted",
			"x_generator": {
				"engine": "bippy-a5840b7849dd"
			}
		}
	}
}
