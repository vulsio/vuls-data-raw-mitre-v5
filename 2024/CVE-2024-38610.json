{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.1",
	"cveMetadata": {
		"cveId": "CVE-2024-38610",
		"assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
		"assignerShortName": "Linux",
		"state": "PUBLISHED",
		"datePublished": "2024-06-19T13:56:12.083Z",
		"dateUpdated": "2024-12-19T09:05:35.455Z",
		"dateReserved": "2024-06-18T19:36:34.942Z"
	},
	"containers": {
		"cna": {
			"providerMetadata": {
				"orgID": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
				"shortName": "Linux",
				"dateUpdated": "2024-12-19T09:05:35.455Z"
			},
			"title": "drivers/virt/acrn: fix PFNMAP PTE checks in acrn_vm_ram_map()",
			"descriptions": [
				{
					"lang": "en",
					"value": "In the Linux kernel, the following vulnerability has been resolved:\n\ndrivers/virt/acrn: fix PFNMAP PTE checks in acrn_vm_ram_map()\n\nPatch series \"mm: follow_pte() improvements and acrn follow_pte() fixes\".\n\nPatch #1 fixes a bunch of issues I spotted in the acrn driver.  It\ncompiles, that's all I know.  I'll appreciate some review and testing from\nacrn folks.\n\nPatch #2+#3 improve follow_pte(), passing a VMA instead of the MM, adding\nmore sanity checks, and improving the documentation.  Gave it a quick test\non x86-64 using VM_PAT that ends up using follow_pte().\n\n\nThis patch (of 3):\n\nWe currently miss handling various cases, resulting in a dangerous\nfollow_pte() (previously follow_pfn()) usage.\n\n(1) We're not checking PTE write permissions.\n\nMaybe we should simply always require pte_write() like we do for\npin_user_pages_fast(FOLL_WRITE)? Hard to tell, so let's check for\nACRN_MEM_ACCESS_WRITE for now.\n\n(2) We're not rejecting refcounted pages.\n\nAs we are not using MMU notifiers, messing with refcounted pages is\ndangerous and can result in use-after-free. Let's make sure to reject them.\n\n(3) We are only looking at the first PTE of a bigger range.\n\nWe only lookup a single PTE, but memmap->len may span a larger area.\nLet's loop over all involved PTEs and make sure the PFN range is\nactually contiguous. Reject everything else: it couldn't have worked\neither way, and rather made use access PFNs we shouldn't be accessing."
				}
			],
			"affected": [
				{
					"vendor": "Linux",
					"product": "Linux",
					"programFiles": [
						"drivers/virt/acrn/mm.c"
					],
					"repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
					"defaultStatus": "unaffected",
					"versions": [
						{
							"status": "affected",
							"versionType": "git",
							"version": "b9c43aa0b18da5619aac347d54cb67fe30d1f884",
							"lessThan": "5c6705aa47b5b78d7ad36fea832bb69caa5bf49a"
						},
						{
							"status": "affected",
							"versionType": "git",
							"version": "8a6e85f75a83d16a71077e41f2720c691f432002",
							"lessThan": "afeb0e69627695f759fc73c39c1640dbf8649b32"
						},
						{
							"status": "affected",
							"versionType": "git",
							"version": "8a6e85f75a83d16a71077e41f2720c691f432002",
							"lessThan": "e873f36ec890bece26ecce850e969917bceebbb6"
						},
						{
							"status": "affected",
							"versionType": "git",
							"version": "8a6e85f75a83d16a71077e41f2720c691f432002",
							"lessThan": "4c4ba3cf3a15ccfbaf787d0296fa42cdb00da9b4"
						},
						{
							"status": "affected",
							"versionType": "git",
							"version": "8a6e85f75a83d16a71077e41f2720c691f432002",
							"lessThan": "2c8d6e24930b8ef7d4a81787627c559ae0e0d3bb"
						},
						{
							"status": "affected",
							"versionType": "git",
							"version": "8a6e85f75a83d16a71077e41f2720c691f432002",
							"lessThan": "3d6586008f7b638f91f3332602592caa8b00b559"
						}
					]
				},
				{
					"vendor": "Linux",
					"product": "Linux",
					"programFiles": [
						"drivers/virt/acrn/mm.c"
					],
					"repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
					"defaultStatus": "affected",
					"versions": [
						{
							"status": "affected",
							"version": "5.18"
						},
						{
							"status": "unaffected",
							"versionType": "semver",
							"version": "0",
							"lessThan": "5.18"
						},
						{
							"status": "unaffected",
							"versionType": "semver",
							"version": "5.15.161",
							"lessThanOrEqual": "5.15.*"
						},
						{
							"status": "unaffected",
							"versionType": "semver",
							"version": "6.1.93",
							"lessThanOrEqual": "6.1.*"
						},
						{
							"status": "unaffected",
							"versionType": "semver",
							"version": "6.6.33",
							"lessThanOrEqual": "6.6.*"
						},
						{
							"status": "unaffected",
							"versionType": "semver",
							"version": "6.8.12",
							"lessThanOrEqual": "6.8.*"
						},
						{
							"status": "unaffected",
							"versionType": "semver",
							"version": "6.9.3",
							"lessThanOrEqual": "6.9.*"
						},
						{
							"status": "unaffected",
							"versionType": "original_commit_for_fix",
							"version": "6.10",
							"lessThanOrEqual": "*"
						}
					]
				}
			],
			"references": [
				{
					"url": "https://git.kernel.org/stable/c/5c6705aa47b5b78d7ad36fea832bb69caa5bf49a"
				},
				{
					"url": "https://git.kernel.org/stable/c/afeb0e69627695f759fc73c39c1640dbf8649b32"
				},
				{
					"url": "https://git.kernel.org/stable/c/e873f36ec890bece26ecce850e969917bceebbb6"
				},
				{
					"url": "https://git.kernel.org/stable/c/4c4ba3cf3a15ccfbaf787d0296fa42cdb00da9b4"
				},
				{
					"url": "https://git.kernel.org/stable/c/2c8d6e24930b8ef7d4a81787627c559ae0e0d3bb"
				},
				{
					"url": "https://git.kernel.org/stable/c/3d6586008f7b638f91f3332602592caa8b00b559"
				}
			],
			"x_generator": {
				"engine": "bippy-5f407fcff5a0"
			}
		},
		"adp": [
			{
				"providerMetadata": {
					"orgID": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
					"shortName": "CISA-ADP",
					"dateUpdated": "2024-06-24T18:15:07.284Z"
				},
				"title": "CISA ADP Vulnrichment",
				"metrics": [
					{
						"other": {
							"type": "ssvc",
							"content": {
								"id": "CVE-2024-38610",
								"options": [
									{
										"Exploitation": "none"
									},
									{
										"Automatable": "no"
									},
									{
										"Technical Impact": "partial"
									}
								],
								"role": "CISA Coordinator",
								"timestamp": "2024-06-24T18:14:59.732296Z",
								"version": "2.0.3"
							}
						}
					}
				]
			},
			{
				"providerMetadata": {
					"orgID": "af854a3a-2127-422b-91ae-364da2661108",
					"shortName": "CVE",
					"dateUpdated": "2024-08-02T04:12:25.993Z"
				},
				"title": "CVE Program Container",
				"references": [
					{
						"tags": [
							"x_transferred"
						],
						"url": "https://git.kernel.org/stable/c/5c6705aa47b5b78d7ad36fea832bb69caa5bf49a"
					},
					{
						"tags": [
							"x_transferred"
						],
						"url": "https://git.kernel.org/stable/c/afeb0e69627695f759fc73c39c1640dbf8649b32"
					},
					{
						"tags": [
							"x_transferred"
						],
						"url": "https://git.kernel.org/stable/c/e873f36ec890bece26ecce850e969917bceebbb6"
					},
					{
						"tags": [
							"x_transferred"
						],
						"url": "https://git.kernel.org/stable/c/4c4ba3cf3a15ccfbaf787d0296fa42cdb00da9b4"
					},
					{
						"tags": [
							"x_transferred"
						],
						"url": "https://git.kernel.org/stable/c/2c8d6e24930b8ef7d4a81787627c559ae0e0d3bb"
					},
					{
						"tags": [
							"x_transferred"
						],
						"url": "https://git.kernel.org/stable/c/3d6586008f7b638f91f3332602592caa8b00b559"
					}
				]
			}
		]
	}
}
