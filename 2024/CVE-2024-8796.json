{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.1",
	"cveMetadata": {
		"cveId": "CVE-2024-8796",
		"assignerOrgId": "8cad7728-009c-4a3d-a95e-ca62e6ff8a0b",
		"assignerShortName": "SNPS",
		"state": "PUBLISHED",
		"datePublished": "2024-09-17T17:12:13.468Z",
		"dateUpdated": "2024-09-17T17:40:01.242Z",
		"dateReserved": "2024-09-13T16:52:10.095Z"
	},
	"containers": {
		"cna": {
			"providerMetadata": {
				"orgID": "8cad7728-009c-4a3d-a95e-ca62e6ff8a0b",
				"shortName": "SNPS",
				"dateUpdated": "2024-09-17T17:40:01.242Z"
			},
			"title": "Insufficient Default OTP Shared Secret Length",
			"descriptions": [
				{
					"lang": "en",
					"value": "Under the default configuration, Devise-Two-Factor versions >= 2.2.0 & < 6.0.0 generate TOTP shared secrets that are 120 bits instead of the 128-bit minimum defined by RFC 4226. Using a shared secret shorter than the minimum to generate a multi-factor authentication code could make it easier for an attacker to guess the shared secret and generate valid TOTP codes.",
					"supportingMedia": [
						{
							"type": "text/html",
							"base64": false,
							"value": "Under the default configuration, Devise-Two-Factor versions &gt;= 2.2.0 &amp; &lt; 6.0.0 generate TOTP shared secrets that are 120 bits instead of the 128-bit minimum defined by RFC 4226. Using a shared secret shorter than the minimum to generate a multi-factor authentication code could make it easier for an attacker to guess the shared secret and generate valid TOTP codes."
						}
					]
				}
			],
			"affected": [
				{
					"vendor": "devise-two-factor",
					"product": "devise-two-factor",
					"packageName": "devise-two-factor",
					"defaultStatus": "unaffected",
					"versions": [
						{
							"status": "affected",
							"versionType": "custom",
							"version": "2.2.0",
							"lessThan": "6.0.0"
						}
					]
				}
			],
			"problemTypes": [
				{
					"descriptions": [
						{
							"type": "CWE",
							"lang": "en",
							"description": "CWE-331 Insufficient Entropy",
							"cweId": "CWE-331"
						}
					]
				}
			],
			"impacts": [
				{
					"descriptions": [
						{
							"lang": "en",
							"value": "CAPEC-59 Session Credential Falsification through Prediction"
						}
					],
					"capecId": "CAPEC-59"
				}
			],
			"metrics": [
				{
					"format": "CVSS",
					"scenarios": [
						{
							"lang": "en",
							"value": "GENERAL"
						}
					],
					"cvssV4_0": {
						"version": "4.0",
						"vectorString": "CVSS:4.0/AV:N/AC:H/AT:P/PR:L/UI:N/VC:H/VI:N/VA:N/SC:N/SI:N/SA:N",
						"baseScore": 6,
						"baseSeverity": "MEDIUM",
						"attackVector": "NETWORK",
						"attackComplexity": "HIGH",
						"attackRequirements": "PRESENT",
						"privilegesRequired": "LOW",
						"userInteraction": "NONE",
						"vulnConfidentialityImpact": "HIGH",
						"vulnIntegrityImpact": "NONE",
						"vulnAvailabilityImpact": "NONE",
						"subConfidentialityImpact": "NONE",
						"subIntegrityImpact": "NONE",
						"subAvailabilityImpact": "NONE",
						"Safety": "NOT_DEFINED",
						"Automatable": "NOT_DEFINED",
						"Recovery": "NOT_DEFINED",
						"valueDensity": "NOT_DEFINED",
						"vulnerabilityResponseEffort": "NOT_DEFINED",
						"providerUrgency": "NOT_DEFINED"
					}
				},
				{
					"format": "CVSS",
					"scenarios": [
						{
							"lang": "en",
							"value": "GENERAL"
						}
					],
					"cvssV3_1": {
						"version": "3.1",
						"vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:N/A:N",
						"attackVector": "NETWORK",
						"attackComplexity": "HIGH",
						"privilegesRequired": "LOW",
						"userInteraction": "NONE",
						"scope": "UNCHANGED",
						"confidentialityImpact": "HIGH",
						"integrityImpact": "NONE",
						"availabilityImpact": "NONE",
						"baseScore": 5.3,
						"baseSeverity": "MEDIUM"
					}
				}
			],
			"workarounds": [
				{
					"lang": "en",
					"value": "If upgrading is not possible, you can override the default otp_secret_length attribute in the model when configuring two_factor_authenticable and set it to a value of at least 26 to ensure newly generated shared secrets are at least 128-bits long.",
					"supportingMedia": [
						{
							"type": "text/html",
							"base64": false,
							"value": "If upgrading is not possible, you can override the default otp_secret_length attribute in the model when configuring two_factor_authenticable and set it to a value of at least 26 to ensure newly generated shared secrets are at least 128-bits long.<br>"
						}
					]
				}
			],
			"solutions": [
				{
					"lang": "en",
					"value": "Devise-Two-Factor should be upgraded to version v6.0.0 as soon as possible. After upgrading, the length of shared secrets and TOTP URLs generated by the library will increase since the new shared secrets will be longer.\n\nAfter upgrading or implementing the workaround, applications using Devise-Two-Factor may wish to migrate users to the new OTP length to provide increased protection for those accounts. Turning off OTP for users by setting otp_required_for_login to false is not recommended since it would leave accounts unprotected. However, you may wish to implement application logic that checks the length of a user's shared secret and prompts users to re-enroll in OTP.",
					"supportingMedia": [
						{
							"type": "text/html",
							"base64": false,
							"value": "Devise-Two-Factor should be upgraded to version v6.0.0 as soon as possible. After upgrading, the length of shared secrets and TOTP URLs generated by the library will increase since the new shared secrets will be longer.<br><br>After upgrading or implementing the workaround, applications using Devise-Two-Factor may wish to migrate users to the new OTP length to provide increased protection for those accounts. Turning off OTP for users by setting otp_required_for_login to false is not recommended since it would leave accounts unprotected. However, you may wish to implement application logic that checks the length of a user's shared secret and prompts users to re-enroll in OTP.<br><br><br>"
						}
					]
				}
			],
			"references": [
				{
					"tags": [
						"vendor-advisory"
					],
					"url": "https://github.com/devise-two-factor/devise-two-factor/security/advisories/GHSA-qjxf-mc72-wjr2"
				}
			],
			"credits": [
				{
					"type": "analyst",
					"lang": "en",
					"value": "Mark Adams"
				},
				{
					"type": "finder",
					"lang": "en",
					"value": "Garrett Rappaport"
				}
			],
			"source": {
				"discovery": "USER"
			},
			"datePublic": "2024-09-17T17:00:00.000Z",
			"x_generator": {
				"engine": "Vulnogram 0.2.0"
			}
		}
	}
}
