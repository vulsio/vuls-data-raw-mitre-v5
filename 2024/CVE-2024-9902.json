{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.1",
	"cveMetadata": {
		"cveId": "CVE-2024-9902",
		"assignerOrgId": "53f830b8-0a3f-465b-8143-3b8a9948e749",
		"assignerShortName": "redhat",
		"state": "PUBLISHED",
		"datePublished": "2024-11-06T09:56:54.505Z",
		"dateUpdated": "2024-12-24T03:26:30.045Z",
		"dateReserved": "2024-10-12T02:46:57.580Z"
	},
	"containers": {
		"cna": {
			"providerMetadata": {
				"orgID": "53f830b8-0a3f-465b-8143-3b8a9948e749",
				"shortName": "redhat",
				"dateUpdated": "2024-12-24T03:26:30.045Z"
			},
			"title": "Ansible-core: ansible-core user may read/write unauthorized content",
			"descriptions": [
				{
					"lang": "en",
					"value": "A flaw was found in Ansible. The ansible-core `user` module can allow an unprivileged user to silently create or replace the contents of any file on any system path and take ownership of it when a privileged user executes the `user` module against the unprivileged user's home directory. If the unprivileged user has traversal permissions on the directory containing the exploited target file, they retain full control over the contents of the file as its owner."
				}
			],
			"affected": [
				{
					"collectionURL": "https://github.com/ansible/ansible",
					"packageName": "ansible-core",
					"defaultStatus": "unaffected",
					"versions": [
						{
							"status": "affected",
							"versionType": "custom",
							"version": "0",
							"lessThan": "2.14.18rc1"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "2.15.0b1",
							"lessThan": "2.15.13rc1"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "2.16.0b1",
							"lessThan": "2.16.13rc1"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "2.17.0b1",
							"lessThan": "2.17.6rc1"
						},
						{
							"status": "affected",
							"versionType": "custom",
							"version": "2.18.0b1",
							"lessThan": "2.18.0rc2"
						}
					]
				},
				{
					"vendor": "Red Hat",
					"product": "Ansible Automation Platform Execution Environments",
					"collectionURL": "https://catalog.redhat.com/software/containers/",
					"packageName": "ansible-automation-platform/ansible-builder-rhel8",
					"cpes": [
						"cpe:/a:redhat:ansible_automation_platform:ee::el8",
						"cpe:/a:redhat:ansible_automation_platform:ee::el9"
					],
					"defaultStatus": "affected",
					"versions": [
						{
							"status": "unaffected",
							"versionType": "rpm",
							"version": "3.0.1-96",
							"lessThan": "*"
						}
					]
				},
				{
					"vendor": "Red Hat",
					"product": "Ansible Automation Platform Execution Environments",
					"collectionURL": "https://catalog.redhat.com/software/containers/",
					"packageName": "ansible-automation-platform/ansible-builder-rhel9",
					"cpes": [
						"cpe:/a:redhat:ansible_automation_platform:ee::el8",
						"cpe:/a:redhat:ansible_automation_platform:ee::el9"
					],
					"defaultStatus": "affected",
					"versions": [
						{
							"status": "unaffected",
							"versionType": "rpm",
							"version": "3.0.1-95",
							"lessThan": "*"
						}
					]
				},
				{
					"vendor": "Red Hat",
					"product": "Ansible Automation Platform Execution Environments",
					"collectionURL": "https://catalog.redhat.com/software/containers/",
					"packageName": "ansible-automation-platform/ee-29-rhel8",
					"cpes": [
						"cpe:/a:redhat:ansible_automation_platform:ee::el8",
						"cpe:/a:redhat:ansible_automation_platform:ee::el9"
					],
					"defaultStatus": "affected",
					"versions": [
						{
							"status": "unaffected",
							"versionType": "rpm",
							"version": "2.9.27-32",
							"lessThan": "*"
						}
					]
				},
				{
					"vendor": "Red Hat",
					"product": "Ansible Automation Platform Execution Environments",
					"collectionURL": "https://catalog.redhat.com/software/containers/",
					"packageName": "ansible-automation-platform/ee-minimal-rhel8",
					"cpes": [
						"cpe:/a:redhat:ansible_automation_platform:ee::el8",
						"cpe:/a:redhat:ansible_automation_platform:ee::el9"
					],
					"defaultStatus": "affected",
					"versions": [
						{
							"status": "unaffected",
							"versionType": "rpm",
							"version": "2.15.12-16",
							"lessThan": "*"
						}
					]
				},
				{
					"vendor": "Red Hat",
					"product": "Ansible Automation Platform Execution Environments",
					"collectionURL": "https://catalog.redhat.com/software/containers/",
					"packageName": "ansible-automation-platform/ee-minimal-rhel9",
					"cpes": [
						"cpe:/a:redhat:ansible_automation_platform:ee::el8",
						"cpe:/a:redhat:ansible_automation_platform:ee::el9"
					],
					"defaultStatus": "affected",
					"versions": [
						{
							"status": "unaffected",
							"versionType": "rpm",
							"version": "2.16.13-2",
							"lessThan": "*"
						}
					]
				},
				{
					"vendor": "Red Hat",
					"product": "Red Hat Ansible Automation Platform 2.4 for RHEL 8",
					"collectionURL": "https://access.redhat.com/downloads/content/package-browser/",
					"packageName": "ansible-core",
					"cpes": [
						"cpe:/a:redhat:ansible_automation_platform_inside:2.4::el8",
						"cpe:/a:redhat:ansible_automation_platform:2.4::el9",
						"cpe:/a:redhat:ansible_automation_platform:2.4::el8",
						"cpe:/a:redhat:ansible_automation_platform_inside:2.4::el9",
						"cpe:/a:redhat:ansible_automation_platform_developer:2.4::el9",
						"cpe:/a:redhat:ansible_automation_platform_developer:2.4::el8"
					],
					"defaultStatus": "affected",
					"versions": [
						{
							"status": "unaffected",
							"versionType": "rpm",
							"version": "1:2.15.13-1.el8ap",
							"lessThan": "*"
						}
					]
				},
				{
					"vendor": "Red Hat",
					"product": "Red Hat Ansible Automation Platform 2.4 for RHEL 9",
					"collectionURL": "https://access.redhat.com/downloads/content/package-browser/",
					"packageName": "ansible-core",
					"cpes": [
						"cpe:/a:redhat:ansible_automation_platform_inside:2.4::el8",
						"cpe:/a:redhat:ansible_automation_platform:2.4::el9",
						"cpe:/a:redhat:ansible_automation_platform:2.4::el8",
						"cpe:/a:redhat:ansible_automation_platform_inside:2.4::el9",
						"cpe:/a:redhat:ansible_automation_platform_developer:2.4::el9",
						"cpe:/a:redhat:ansible_automation_platform_developer:2.4::el8"
					],
					"defaultStatus": "affected",
					"versions": [
						{
							"status": "unaffected",
							"versionType": "rpm",
							"version": "1:2.15.13-1.el9ap",
							"lessThan": "*"
						}
					]
				},
				{
					"vendor": "Red Hat",
					"product": "Red Hat Ansible Automation Platform 2.5 for RHEL 8",
					"collectionURL": "https://access.redhat.com/downloads/content/package-browser/",
					"packageName": "ansible-core",
					"cpes": [
						"cpe:/a:redhat:ansible_automation_platform_developer:2.5::el9",
						"cpe:/a:redhat:ansible_automation_platform:2.5::el8",
						"cpe:/a:redhat:ansible_automation_platform:2.5::el9",
						"cpe:/a:redhat:ansible_automation_platform_inside:2.5::el8",
						"cpe:/a:redhat:ansible_automation_platform_developer:2.5::el8",
						"cpe:/a:redhat:ansible_automation_platform_inside:2.5::el9"
					],
					"defaultStatus": "affected",
					"versions": [
						{
							"status": "unaffected",
							"versionType": "rpm",
							"version": "1:2.16.13-1.el8ap",
							"lessThan": "*"
						}
					]
				},
				{
					"vendor": "Red Hat",
					"product": "Red Hat Ansible Automation Platform 2.5 for RHEL 9",
					"collectionURL": "https://access.redhat.com/downloads/content/package-browser/",
					"packageName": "ansible-core",
					"cpes": [
						"cpe:/a:redhat:ansible_automation_platform_developer:2.5::el9",
						"cpe:/a:redhat:ansible_automation_platform:2.5::el8",
						"cpe:/a:redhat:ansible_automation_platform:2.5::el9",
						"cpe:/a:redhat:ansible_automation_platform_inside:2.5::el8",
						"cpe:/a:redhat:ansible_automation_platform_developer:2.5::el8",
						"cpe:/a:redhat:ansible_automation_platform_inside:2.5::el9"
					],
					"defaultStatus": "affected",
					"versions": [
						{
							"status": "unaffected",
							"versionType": "rpm",
							"version": "1:2.16.13-1.el9ap",
							"lessThan": "*"
						}
					]
				},
				{
					"vendor": "Red Hat",
					"product": "Red Hat OpenStack Platform 17.1",
					"collectionURL": "https://access.redhat.com/downloads/content/package-browser/",
					"packageName": "openstack-ansible-core",
					"cpes": [
						"cpe:/a:redhat:openstack:17.1"
					],
					"defaultStatus": "affected"
				}
			],
			"problemTypes": [
				{
					"descriptions": [
						{
							"type": "CWE",
							"lang": "en",
							"description": "Incorrect Authorization",
							"cweId": "CWE-863"
						}
					]
				}
			],
			"metrics": [
				{
					"other": {
						"type": "Red Hat severity rating",
						"content": {
							"namespace": "https://access.redhat.com/security/updates/classification/",
							"value": "Moderate"
						}
					}
				},
				{
					"format": "CVSS",
					"cvssV3_1": {
						"version": "3.1",
						"vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:L",
						"attackVector": "LOCAL",
						"attackComplexity": "HIGH",
						"privilegesRequired": "LOW",
						"userInteraction": "REQUIRED",
						"scope": "UNCHANGED",
						"confidentialityImpact": "HIGH",
						"integrityImpact": "HIGH",
						"availabilityImpact": "LOW",
						"baseScore": 6.3,
						"baseSeverity": "MEDIUM"
					}
				}
			],
			"workarounds": [
				{
					"lang": "en",
					"value": "In the play that uses the user module with the key generation option,\nhave a prior task ensuring the public key does not exist for example:\n\n- name: avoid user exploit (change name depending on other options\nused in user task)\nfile: path=/home/{{username}}/.ssh/id_rsa.pub state=absent"
				}
			],
			"references": [
				{
					"name": "RHSA-2024:10762",
					"tags": [
						"vendor-advisory",
						"x_refsource_REDHAT"
					],
					"url": "https://access.redhat.com/errata/RHSA-2024:10762"
				},
				{
					"name": "RHSA-2024:8969",
					"tags": [
						"vendor-advisory",
						"x_refsource_REDHAT"
					],
					"url": "https://access.redhat.com/errata/RHSA-2024:8969"
				},
				{
					"name": "RHSA-2024:9894",
					"tags": [
						"vendor-advisory",
						"x_refsource_REDHAT"
					],
					"url": "https://access.redhat.com/errata/RHSA-2024:9894"
				},
				{
					"tags": [
						"vdb-entry",
						"x_refsource_REDHAT"
					],
					"url": "https://access.redhat.com/security/cve/CVE-2024-9902"
				},
				{
					"name": "RHBZ#2318271",
					"tags": [
						"issue-tracking",
						"x_refsource_REDHAT"
					],
					"url": "https://bugzilla.redhat.com/show_bug.cgi?id=2318271"
				}
			],
			"timeline": [
				{
					"time": "2024-10-12T02:41:32.581000+00:00",
					"lang": "en",
					"value": "Reported to Red Hat."
				},
				{
					"time": "2024-11-06T06:11:25.611000+00:00",
					"lang": "en",
					"value": "Made public."
				}
			],
			"credits": [
				{
					"lang": "en",
					"value": "Red Hat would like to thank Matt Clay for reporting this issue."
				}
			],
			"datePublic": "2024-11-06T06:11:25.611000+00:00",
			"x_redhatCweChain": "CWE-863: Incorrect Authorization"
		},
		"adp": [
			{
				"providerMetadata": {
					"orgID": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
					"shortName": "CISA-ADP",
					"dateUpdated": "2024-11-06T14:21:06.565Z"
				},
				"title": "CISA ADP Vulnrichment",
				"metrics": [
					{
						"other": {
							"type": "ssvc",
							"content": {
								"id": "CVE-2024-9902",
								"options": [
									{
										"Exploitation": "none"
									},
									{
										"Automatable": "no"
									},
									{
										"Technical Impact": "total"
									}
								],
								"role": "CISA Coordinator",
								"timestamp": "2024-11-06T14:20:56.915379Z",
								"version": "2.0.3"
							}
						}
					}
				]
			}
		]
	}
}
