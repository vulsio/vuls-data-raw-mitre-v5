{
	"dataType": "CVE_RECORD",
	"dataVersion": "5.1",
	"cveMetadata": {
		"cveId": "CVE-2024-56699",
		"assignerOrgId": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
		"assignerShortName": "Linux",
		"state": "PUBLISHED",
		"datePublished": "2024-12-28T09:46:22.034Z",
		"dateUpdated": "2025-01-20T06:26:26.879Z",
		"dateReserved": "2024-12-27T15:00:39.851Z"
	},
	"containers": {
		"cna": {
			"providerMetadata": {
				"orgID": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
				"shortName": "Linux",
				"dateUpdated": "2025-01-20T06:26:26.879Z"
			},
			"title": "s390/pci: Fix potential double remove of hotplug slot",
			"descriptions": [
				{
					"lang": "en",
					"value": "In the Linux kernel, the following vulnerability has been resolved:\n\ns390/pci: Fix potential double remove of hotplug slot\n\nIn commit 6ee600bfbe0f (\"s390/pci: remove hotplug slot when releasing the\ndevice\") the zpci_exit_slot() was moved from zpci_device_reserved() to\nzpci_release_device() with the intention of keeping the hotplug slot\naround until the device is actually removed.\n\nNow zpci_release_device() is only called once all references are\ndropped. Since the zPCI subsystem only drops its reference once the\ndevice is in the reserved state it follows that zpci_release_device()\nmust only deal with devices in the reserved state. Despite that it\ncontains code to tear down from both configured and standby state. For\nthe standby case this already includes the removal of the hotplug slot\nso would cause a double removal if a device was ever removed in\neither configured or standby state.\n\nInstead of causing a potential double removal in a case that should\nnever happen explicitly WARN_ON() if a device in non-reserved state is\nreleased and get rid of the dead code cases."
				}
			],
			"affected": [
				{
					"vendor": "Linux",
					"product": "Linux",
					"programFiles": [
						"arch/s390/pci/pci.c"
					],
					"repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
					"defaultStatus": "unaffected",
					"versions": [
						{
							"status": "affected",
							"versionType": "git",
							"version": "6ee600bfbe0f818ffb7748d99e9b0c89d0d9f02a",
							"lessThan": "c1489651071ab1be46d2af1da8adb15c9fc3c069"
						},
						{
							"status": "affected",
							"versionType": "git",
							"version": "6ee600bfbe0f818ffb7748d99e9b0c89d0d9f02a",
							"lessThan": "371bd905599d18da62d75e3974acbf6a41e315c7"
						},
						{
							"status": "affected",
							"versionType": "git",
							"version": "6ee600bfbe0f818ffb7748d99e9b0c89d0d9f02a",
							"lessThan": "c4a585e952ca403a370586d3f16e8331a7564901"
						}
					]
				},
				{
					"vendor": "Linux",
					"product": "Linux",
					"programFiles": [
						"arch/s390/pci/pci.c"
					],
					"repo": "https://git.kernel.org/pub/scm/linux/kernel/git/stable/linux.git",
					"defaultStatus": "affected",
					"versions": [
						{
							"status": "affected",
							"version": "6.9"
						},
						{
							"status": "unaffected",
							"versionType": "semver",
							"version": "0",
							"lessThan": "6.9"
						},
						{
							"status": "unaffected",
							"versionType": "semver",
							"version": "6.11.11",
							"lessThanOrEqual": "6.11.*"
						},
						{
							"status": "unaffected",
							"versionType": "semver",
							"version": "6.12.2",
							"lessThanOrEqual": "6.12.*"
						},
						{
							"status": "unaffected",
							"versionType": "original_commit_for_fix",
							"version": "6.13",
							"lessThanOrEqual": "*"
						}
					]
				}
			],
			"references": [
				{
					"url": "https://git.kernel.org/stable/c/c1489651071ab1be46d2af1da8adb15c9fc3c069"
				},
				{
					"url": "https://git.kernel.org/stable/c/371bd905599d18da62d75e3974acbf6a41e315c7"
				},
				{
					"url": "https://git.kernel.org/stable/c/c4a585e952ca403a370586d3f16e8331a7564901"
				}
			],
			"x_generator": {
				"engine": "bippy-5f407fcff5a0"
			}
		}
	}
}
